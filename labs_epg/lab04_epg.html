<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Econometría para la Gestión (ECO_EPG) - FEN UAH">

<title>Capitulo_4_Uso_de_la_Regresion_Multiple</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-360b3b5b5cb1aa80d6666be010f1eb0d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No se han encontrado resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo.png" alt="" class="navbar-logo light-content">
    <img src="../img/logo.png" alt="" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../codigos.html"> 
<span class="menu-text">Material de Estudio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../datos.html"> 
<span class="menu-text">Datos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../proyectos.html"> 
<span class="menu-text">Proyectos</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#material-descargable" id="toc-material-descargable" class="nav-link active" data-scroll-target="#material-descargable"><span class="header-section-number">1</span> 1. Material descargable</a></li>
  <li><a href="#configuración-inicial-en-r" id="toc-configuración-inicial-en-r" class="nav-link" data-scroll-target="#configuración-inicial-en-r"><span class="header-section-number">2</span> Configuración inicial en R</a>
  <ul class="collapse">
  <li><a href="#carga-de-librerías" id="toc-carga-de-librerías" class="nav-link" data-scroll-target="#carga-de-librerías"><span class="header-section-number">2.1</span> Carga de librerías</a></li>
  <li><a href="#definir-ruta-de-trabajo" id="toc-definir-ruta-de-trabajo" class="nav-link" data-scroll-target="#definir-ruta-de-trabajo"><span class="header-section-number">2.2</span> Definir ruta de trabajo</a></li>
  </ul></li>
  <li><a href="#parte-1-regresión-múltiple-con-inversión-publicitaria-tv-radio-periodico" id="toc-parte-1-regresión-múltiple-con-inversión-publicitaria-tv-radio-periodico" class="nav-link" data-scroll-target="#parte-1-regresión-múltiple-con-inversión-publicitaria-tv-radio-periodico"><span class="header-section-number">3</span> Parte 1: Regresión múltiple con inversión publicitaria (tv, radio, periodico)</a>
  <ul class="collapse">
  <li><a href="#crear-el-conjunto-de-datos" id="toc-crear-el-conjunto-de-datos" class="nav-link" data-scroll-target="#crear-el-conjunto-de-datos"><span class="header-section-number">3.1</span> Crear el conjunto de datos</a></li>
  <li><a href="#correlaciones-y-multicolinealidad" id="toc-correlaciones-y-multicolinealidad" class="nav-link" data-scroll-target="#correlaciones-y-multicolinealidad"><span class="header-section-number">3.2</span> Correlaciones y multicolinealidad</a></li>
  <li><a href="#modelo-con-las-tres-variables" id="toc-modelo-con-las-tres-variables" class="nav-link" data-scroll-target="#modelo-con-las-tres-variables"><span class="header-section-number">3.3</span> Modelo con las tres variables</a></li>
  <li><a href="#modelo-sin-variable-no-significativa" id="toc-modelo-sin-variable-no-significativa" class="nav-link" data-scroll-target="#modelo-sin-variable-no-significativa"><span class="header-section-number">3.4</span> Modelo sin variable no significativa</a></li>
  <li><a href="#superficie-de-regresión-en-3d" id="toc-superficie-de-regresión-en-3d" class="nav-link" data-scroll-target="#superficie-de-regresión-en-3d"><span class="header-section-number">3.5</span> Superficie de regresión en 3D</a></li>
  <li><a href="#análisis-de-residuos-del-modelo-reducido" id="toc-análisis-de-residuos-del-modelo-reducido" class="nav-link" data-scroll-target="#análisis-de-residuos-del-modelo-reducido"><span class="header-section-number">3.6</span> Análisis de residuos del modelo reducido</a></li>
  <li><a href="#incorporar-una-interacción-tv-radio" id="toc-incorporar-una-interacción-tv-radio" class="nav-link" data-scroll-target="#incorporar-una-interacción-tv-radio"><span class="header-section-number">3.7</span> Incorporar una interacción tv * radio</a></li>
  <li><a href="#superficie-del-modelo-con-interacción" id="toc-superficie-del-modelo-con-interacción" class="nav-link" data-scroll-target="#superficie-del-modelo-con-interacción"><span class="header-section-number">3.8</span> Superficie del modelo con interacción</a></li>
  <li><a href="#comparación-de-modelos-con-anova" id="toc-comparación-de-modelos-con-anova" class="nav-link" data-scroll-target="#comparación-de-modelos-con-anova"><span class="header-section-number">3.9</span> Comparación de modelos con ANOVA</a></li>
  <li><a href="#modelo-con-interacción-y-término-cuadrático-en-tv" id="toc-modelo-con-interacción-y-término-cuadrático-en-tv" class="nav-link" data-scroll-target="#modelo-con-interacción-y-término-cuadrático-en-tv"><span class="header-section-number">3.10</span> Modelo con interacción y término cuadrático en tv</a></li>
  </ul></li>
  <li><a href="#parte-2-regresión-polinomial-y-transformaciones-ejemplo-de-millaje" id="toc-parte-2-regresión-polinomial-y-transformaciones-ejemplo-de-millaje" class="nav-link" data-scroll-target="#parte-2-regresión-polinomial-y-transformaciones-ejemplo-de-millaje"><span class="header-section-number">4</span> Parte 2: Regresión polinomial y transformaciones (ejemplo de millaje)</a>
  <ul class="collapse">
  <li><a href="#cargar-los-datos-de-millaje" id="toc-cargar-los-datos-de-millaje" class="nav-link" data-scroll-target="#cargar-los-datos-de-millaje"><span class="header-section-number">4.1</span> Cargar los datos de millaje</a></li>
  <li><a href="#correlaciones-y-gráficos" id="toc-correlaciones-y-gráficos" class="nav-link" data-scroll-target="#correlaciones-y-gráficos"><span class="header-section-number">4.2</span> Correlaciones y gráficos</a></li>
  <li><a href="#modelo-lineal-simple-en-hp-y-vol" id="toc-modelo-lineal-simple-en-hp-y-vol" class="nav-link" data-scroll-target="#modelo-lineal-simple-en-hp-y-vol"><span class="header-section-number">4.3</span> Modelo lineal simple en hp y vol</a></li>
  <li><a href="#modelo-polinomial-cuadrático" id="toc-modelo-polinomial-cuadrático" class="nav-link" data-scroll-target="#modelo-polinomial-cuadrático"><span class="header-section-number">4.4</span> Modelo polinomial cuadrático</a></li>
  <li><a href="#análisis-de-residuos-del-modelo-polinomial" id="toc-análisis-de-residuos-del-modelo-polinomial" class="nav-link" data-scroll-target="#análisis-de-residuos-del-modelo-polinomial"><span class="header-section-number">4.5</span> Análisis de residuos del modelo polinomial</a></li>
  <li><a href="#curva-predicha-del-modelo-polinomial" id="toc-curva-predicha-del-modelo-polinomial" class="nav-link" data-scroll-target="#curva-predicha-del-modelo-polinomial"><span class="header-section-number">4.6</span> Curva predicha del modelo polinomial</a></li>
  <li><a href="#visualización-con-ggplot2" id="toc-visualización-con-ggplot2" class="nav-link" data-scroll-target="#visualización-con-ggplot2"><span class="header-section-number">4.7</span> Visualización con ggplot2</a></li>
  <li><a href="#polinomios-de-grados-más-altos" id="toc-polinomios-de-grados-más-altos" class="nav-link" data-scroll-target="#polinomios-de-grados-más-altos"><span class="header-section-number">4.8</span> Polinomios de grados más altos</a></li>
  <li><a href="#modelos-polinomiales-y-comparación" id="toc-modelos-polinomiales-y-comparación" class="nav-link" data-scroll-target="#modelos-polinomiales-y-comparación"><span class="header-section-number">4.9</span> Modelos polinomiales y comparación</a></li>
  <li><a href="#transformaciones-de-la-variable-respuesta" id="toc-transformaciones-de-la-variable-respuesta" class="nav-link" data-scroll-target="#transformaciones-de-la-variable-respuesta"><span class="header-section-number">4.10</span> Transformaciones de la variable respuesta</a>
  <ul class="collapse">
  <li><a href="#transformación-logarítmica" id="toc-transformación-logarítmica" class="nav-link" data-scroll-target="#transformación-logarítmica"><span class="header-section-number">4.10.1</span> Transformación logarítmica</a></li>
  <li><a href="#transformación-raíz-cuadrada" id="toc-transformación-raíz-cuadrada" class="nav-link" data-scroll-target="#transformación-raíz-cuadrada"><span class="header-section-number">4.10.2</span> Transformación raíz cuadrada</a></li>
  <li><a href="#transformación-1sqrtmpg" id="toc-transformación-1sqrtmpg" class="nav-link" data-scroll-target="#transformación-1sqrtmpg"><span class="header-section-number">4.10.3</span> Transformación 1/sqrt(mpg)</a></li>
  <li><a href="#transformaciones-más-complejas" id="toc-transformaciones-más-complejas" class="nav-link" data-scroll-target="#transformaciones-más-complejas"><span class="header-section-number">4.10.4</span> Transformaciones más complejas</a></li>
  <li><a href="#modelos-sin-constante-y-selección" id="toc-modelos-sin-constante-y-selección" class="nav-link" data-scroll-target="#modelos-sin-constante-y-selección"><span class="header-section-number">4.10.5</span> Modelos sin constante y selección</a></li>
  <li><a href="#un-modelo-candidato-bueno" id="toc-un-modelo-candidato-bueno" class="nav-link" data-scroll-target="#un-modelo-candidato-bueno"><span class="header-section-number">4.10.6</span> Un modelo candidato “bueno”</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cierre-del-laboratorio" id="toc-cierre-del-laboratorio" class="nav-link" data-scroll-target="#cierre-del-laboratorio"><span class="header-section-number">5</span> Cierre del laboratorio</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="lab04_epg.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Capitulo_4_Uso_de_la_Regresion_Multiple</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Econometría para la Gestión (ECO_EPG) - FEN UAH </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="material-descargable" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> 1. Material descargable</h1>
<p><a href="pdf_epg/Capitulo_4_Uso_de_la_Regresion_Multiple.pdf" download="true">Descargar PDF de contenidos teóricos</a></p>
</section>
<section id="configuración-inicial-en-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Configuración inicial en R</h1>
<section id="carga-de-librerías" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="carga-de-librerías"><span class="header-section-number">2.1</span> Carga de librerías</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)      <span class="co"># funciones adicionales para modelos lineales</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)  <span class="co"># correlaciones gráficas</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)    <span class="co"># pruebas como Durbin-Watson, Breusch-Pagan</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)   <span class="co"># gráficos avanzados</span></span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="definir-ruta-de-trabajo" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="definir-ruta-de-trabajo"><span class="header-section-number">2.2</span> Definir ruta de trabajo</h2>
<p>En tu proyecto utilizaremos la ruta:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ruta_datos <span class="ot">&lt;-</span> <span class="st">"C:/Users/manue/Desktop/lab-econometria/labs_epg/data_epg"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificamos que la carpeta exista y revisamos algunos archivos</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(ruta_datos)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "annos_mantenimiento.xlsx" "auto_peso_consumo.xlsx"  
 [3] "costos.xlsx"              "data_PCA_Decathlon.csv"  
 [5] "data_PCA_ExpertWine.csv"  "Ejemplo1.xlsx"           
 [7] "Ejemplo2.xlsx"            "millaje.txt"             
 [9] "orange.csv"               "tabla_ejemplo_R.xlsx"    </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si copias este laboratorio a otro computador, solo deberás <strong>cambiar la ruta</strong> de <code>ruta_datos</code> para que apunte a la nueva carpeta donde estén <code>millaje.txt</code> y otros archivos de datos.</p>
</div>
</div>
</section>
</section>
<section id="parte-1-regresión-múltiple-con-inversión-publicitaria-tv-radio-periodico" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Parte 1: Regresión múltiple con inversión publicitaria (tv, radio, periodico)</h1>
<p>En esta primera parte trabajaremos con un ejemplo clásico de marketing:</p>
<ul>
<li><strong>tv</strong>: gasto en publicidad en TV (en miles de dólares).<br>
</li>
<li><strong>radio</strong>: gasto en publicidad en radio.<br>
</li>
<li><strong>periodico</strong>: gasto en publicidad en periódicos.<br>
</li>
<li><strong>ventas</strong>: ventas del producto (en miles de unidades).</li>
</ul>
<p>La idea es entender <strong>cómo se relacionan las ventas con los distintos medios publicitarios</strong>, usando regresión múltiple.</p>
<section id="crear-el-conjunto-de-datos" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="crear-el-conjunto-de-datos"><span class="header-section-number">3.1</span> Crear el conjunto de datos</h2>
<p>El script genera los vectores directamente en R y luego los combina en un <code>data.frame</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">230.1</span>, <span class="fl">44.5</span>, <span class="fl">17.2</span>, <span class="fl">151.5</span>, <span class="fl">180.8</span>, <span class="fl">8.7</span>, <span class="fl">57.5</span>, <span class="fl">120.2</span>, <span class="fl">8.6</span>, <span class="fl">199.8</span>, <span class="fl">66.1</span>, <span class="fl">214.7</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>         <span class="fl">23.8</span>, <span class="fl">97.5</span>, <span class="fl">204.1</span>, <span class="fl">195.4</span>, <span class="fl">67.8</span>, <span class="fl">281.4</span>, <span class="fl">69.2</span>, <span class="fl">147.3</span>, <span class="fl">218.4</span>, <span class="fl">237.4</span>, <span class="fl">13.2</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="fl">228.3</span>, <span class="fl">62.3</span>, <span class="fl">262.9</span>, <span class="fl">142.9</span>, <span class="fl">240.1</span>, <span class="fl">248.8</span>, <span class="fl">70.6</span>, <span class="fl">292.9</span>, <span class="fl">112.9</span>, <span class="fl">97.2</span>, <span class="fl">265.6</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="fl">95.7</span>, <span class="fl">290.7</span>, <span class="fl">266.9</span>, <span class="fl">74.7</span>, <span class="fl">43.1</span>, <span class="fl">228.0</span>, <span class="fl">202.5</span>, <span class="fl">177.0</span>, <span class="fl">293.6</span>, <span class="fl">206.9</span>, <span class="fl">25.1</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="fl">175.1</span>, <span class="fl">89.7</span>, <span class="fl">239.9</span>, <span class="fl">227.2</span>, <span class="fl">66.9</span>, <span class="fl">199.8</span>, <span class="fl">100.4</span>, <span class="fl">216.4</span>, <span class="fl">182.6</span>, <span class="fl">262.7</span>, <span class="fl">198.9</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="fl">7.3</span>, <span class="fl">136.2</span>, <span class="fl">210.8</span>, <span class="fl">210.7</span>, <span class="fl">53.5</span>, <span class="fl">261.3</span>, <span class="fl">239.3</span>, <span class="fl">102.7</span>, <span class="fl">131.1</span>, <span class="fl">69.0</span>, <span class="fl">31.5</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="fl">139.3</span>, <span class="fl">237.4</span>, <span class="fl">216.8</span>, <span class="fl">199.1</span>, <span class="fl">109.8</span>, <span class="fl">26.8</span>, <span class="fl">129.4</span>, <span class="fl">213.4</span>, <span class="fl">16.9</span>, <span class="fl">27.5</span>, <span class="fl">120.5</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>         <span class="fl">5.4</span>, <span class="fl">116.0</span>, <span class="fl">76.4</span>, <span class="fl">239.8</span>, <span class="fl">75.3</span>, <span class="fl">68.4</span>, <span class="fl">213.5</span>, <span class="fl">193.2</span>, <span class="fl">76.3</span>, <span class="fl">110.7</span>, <span class="fl">88.3</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="fl">109.8</span>, <span class="fl">134.3</span>, <span class="fl">28.6</span>, <span class="fl">217.7</span>, <span class="fl">250.9</span>, <span class="fl">107.4</span>, <span class="fl">163.3</span>, <span class="fl">197.6</span>, <span class="fl">184.9</span>, <span class="fl">289.7</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="fl">135.2</span>, <span class="fl">222.4</span>, <span class="fl">296.4</span>, <span class="fl">280.2</span>, <span class="fl">187.9</span>, <span class="fl">238.2</span>, <span class="fl">137.9</span>, <span class="fl">25.0</span>, <span class="fl">90.4</span>, <span class="fl">13.1</span>, <span class="fl">255.4</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="fl">225.8</span>, <span class="fl">241.7</span>, <span class="fl">175.7</span>, <span class="fl">209.6</span>, <span class="fl">78.2</span>, <span class="fl">75.1</span>, <span class="fl">139.2</span>, <span class="fl">76.4</span>, <span class="fl">125.7</span>, <span class="fl">19.4</span>, <span class="fl">141.3</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>         <span class="fl">18.8</span>, <span class="fl">224.0</span>, <span class="fl">123.1</span>, <span class="fl">229.5</span>, <span class="fl">87.2</span>, <span class="fl">7.8</span>, <span class="fl">80.2</span>, <span class="fl">220.3</span>, <span class="fl">59.6</span>, <span class="fl">0.7</span>, <span class="fl">265.2</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>         <span class="fl">8.4</span>, <span class="fl">219.8</span>, <span class="fl">36.9</span>, <span class="fl">48.3</span>, <span class="fl">25.6</span>, <span class="fl">273.7</span>, <span class="fl">43.0</span>, <span class="fl">184.9</span>, <span class="fl">73.4</span>, <span class="fl">193.7</span>, <span class="fl">220.5</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>         <span class="fl">104.6</span>, <span class="fl">96.2</span>, <span class="fl">140.3</span>, <span class="fl">240.1</span>, <span class="fl">243.2</span>, <span class="fl">38.0</span>, <span class="fl">44.7</span>, <span class="fl">280.7</span>, <span class="fl">121.0</span>, <span class="fl">197.6</span>, <span class="fl">171.3</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>         <span class="fl">187.8</span>, <span class="fl">4.1</span>, <span class="fl">93.9</span>, <span class="fl">149.8</span>, <span class="fl">11.7</span>, <span class="fl">131.7</span>, <span class="fl">172.5</span>, <span class="fl">85.7</span>, <span class="fl">188.4</span>, <span class="fl">163.5</span>, <span class="fl">117.2</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         <span class="fl">234.5</span>, <span class="fl">17.9</span>, <span class="fl">206.8</span>, <span class="fl">215.4</span>, <span class="fl">284.3</span>, <span class="fl">50.0</span>, <span class="fl">164.5</span>, <span class="fl">19.6</span>, <span class="fl">168.4</span>, <span class="fl">222.4</span>, <span class="fl">276.9</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>         <span class="fl">248.4</span>, <span class="fl">170.2</span>, <span class="fl">276.7</span>, <span class="fl">165.6</span>, <span class="fl">156.6</span>, <span class="fl">218.5</span>, <span class="fl">56.2</span>, <span class="fl">287.6</span>, <span class="fl">253.8</span>, <span class="fl">205.0</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>         <span class="fl">139.5</span>, <span class="fl">191.1</span>, <span class="fl">286.0</span>, <span class="fl">18.7</span>, <span class="fl">39.5</span>, <span class="fl">75.5</span>, <span class="fl">17.2</span>, <span class="fl">166.8</span>, <span class="fl">149.7</span>, <span class="fl">38.2</span>, <span class="fl">94.2</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>         <span class="fl">177.0</span>, <span class="fl">283.6</span>, <span class="fl">232.1</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>radio <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">37.8</span>, <span class="fl">39.3</span>, <span class="fl">45.9</span>, <span class="fl">41.3</span>, <span class="fl">10.8</span>, <span class="fl">48.9</span>, <span class="fl">32.8</span>, <span class="fl">19.6</span>, <span class="fl">2.1</span>, <span class="fl">2.6</span>, <span class="fl">5.8</span>, <span class="fl">24.0</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>           <span class="fl">35.1</span>, <span class="fl">7.6</span>, <span class="fl">32.9</span>, <span class="fl">47.7</span>, <span class="fl">36.6</span>, <span class="fl">39.6</span>, <span class="fl">20.5</span>, <span class="fl">23.9</span>, <span class="fl">27.7</span>, <span class="fl">5.1</span>, <span class="fl">15.9</span>, <span class="fl">16.9</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>           <span class="fl">12.6</span>, <span class="fl">3.5</span>, <span class="fl">29.3</span>, <span class="fl">16.7</span>, <span class="fl">27.1</span>, <span class="fl">16.0</span>, <span class="fl">28.3</span>, <span class="fl">17.4</span>, <span class="fl">1.5</span>, <span class="fl">20.0</span>, <span class="fl">1.4</span>, <span class="fl">4.1</span>,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>           <span class="fl">43.8</span>, <span class="fl">49.4</span>, <span class="fl">26.7</span>, <span class="fl">37.7</span>, <span class="fl">22.3</span>, <span class="fl">33.4</span>, <span class="fl">27.7</span>, <span class="fl">8.4</span>, <span class="fl">25.7</span>, <span class="fl">22.5</span>, <span class="fl">9.9</span>, <span class="fl">41.5</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>           <span class="fl">15.8</span>, <span class="fl">11.7</span>, <span class="fl">3.1</span>, <span class="fl">9.6</span>, <span class="fl">41.7</span>, <span class="fl">46.2</span>, <span class="fl">28.8</span>, <span class="fl">49.4</span>, <span class="fl">28.1</span>, <span class="fl">19.2</span>, <span class="fl">49.6</span>, <span class="fl">29.5</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>           <span class="fl">2.0</span>, <span class="fl">42.7</span>, <span class="fl">15.5</span>, <span class="fl">29.6</span>, <span class="fl">42.8</span>, <span class="fl">9.3</span>, <span class="fl">24.6</span>, <span class="fl">14.5</span>, <span class="fl">27.5</span>, <span class="fl">43.9</span>, <span class="fl">30.6</span>, <span class="fl">14.3</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>           <span class="fl">33.0</span>, <span class="fl">5.7</span>, <span class="fl">24.6</span>, <span class="fl">43.7</span>, <span class="fl">1.6</span>, <span class="fl">28.5</span>, <span class="fl">29.9</span>, <span class="fl">7.7</span>, <span class="fl">26.7</span>, <span class="fl">4.1</span>, <span class="fl">20.3</span>, <span class="fl">44.5</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>           <span class="fl">43.0</span>, <span class="fl">18.4</span>, <span class="fl">27.5</span>, <span class="fl">40.6</span>, <span class="fl">25.5</span>, <span class="fl">47.8</span>, <span class="fl">4.9</span>, <span class="fl">1.5</span>, <span class="fl">33.5</span>, <span class="fl">36.5</span>, <span class="fl">14.0</span>, <span class="fl">31.6</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>           <span class="fl">3.5</span>, <span class="fl">21.0</span>, <span class="fl">42.3</span>, <span class="fl">41.7</span>, <span class="fl">4.3</span>, <span class="fl">36.3</span>, <span class="fl">10.1</span>, <span class="fl">17.2</span>, <span class="fl">34.3</span>, <span class="fl">46.4</span>, <span class="fl">11.0</span>, <span class="fl">0.3</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0.4</span>, <span class="fl">26.9</span>, <span class="fl">8.2</span>, <span class="fl">38.0</span>, <span class="fl">15.4</span>, <span class="fl">20.6</span>, <span class="fl">46.8</span>, <span class="fl">35.0</span>, <span class="fl">14.3</span>, <span class="fl">0.8</span>, <span class="fl">36.9</span>, <span class="fl">16.0</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>           <span class="fl">26.8</span>, <span class="fl">21.7</span>, <span class="fl">2.4</span>, <span class="fl">34.6</span>, <span class="fl">32.3</span>, <span class="fl">11.8</span>, <span class="fl">38.9</span>, <span class="fl">0.0</span>, <span class="fl">49.0</span>, <span class="fl">12.0</span>, <span class="fl">39.6</span>, <span class="fl">2.9</span>,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>           <span class="fl">27.2</span>, <span class="fl">33.5</span>, <span class="fl">38.6</span>, <span class="fl">47.0</span>, <span class="fl">39.0</span>, <span class="fl">28.9</span>, <span class="fl">25.9</span>, <span class="fl">43.9</span>, <span class="fl">17.0</span>, <span class="fl">35.4</span>, <span class="fl">33.2</span>, <span class="fl">5.7</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>           <span class="fl">14.8</span>, <span class="fl">1.9</span>, <span class="fl">7.3</span>, <span class="fl">49.0</span>, <span class="fl">40.3</span>, <span class="fl">25.8</span>, <span class="fl">13.9</span>, <span class="fl">8.4</span>, <span class="fl">23.3</span>, <span class="fl">39.7</span>, <span class="fl">21.1</span>, <span class="fl">11.6</span>,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>           <span class="fl">43.5</span>, <span class="fl">1.3</span>, <span class="fl">36.9</span>, <span class="fl">18.4</span>, <span class="fl">18.1</span>, <span class="fl">35.8</span>, <span class="fl">18.1</span>, <span class="fl">36.8</span>, <span class="fl">14.7</span>, <span class="fl">3.4</span>, <span class="fl">37.6</span>, <span class="fl">5.2</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>           <span class="fl">23.6</span>, <span class="fl">10.6</span>, <span class="fl">11.6</span>, <span class="fl">20.9</span>, <span class="fl">20.1</span>, <span class="fl">7.1</span>, <span class="fl">3.4</span>, <span class="fl">48.9</span>, <span class="fl">30.2</span>, <span class="fl">7.8</span>, <span class="fl">2.3</span>, <span class="fl">10.0</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>           <span class="fl">2.6</span>, <span class="fl">5.4</span>, <span class="fl">5.7</span>, <span class="fl">43.0</span>, <span class="fl">21.3</span>, <span class="fl">45.1</span>, <span class="fl">2.1</span>, <span class="fl">28.7</span>, <span class="fl">13.9</span>, <span class="fl">12.1</span>, <span class="fl">41.1</span>, <span class="fl">10.8</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>           <span class="fl">4.1</span>, <span class="fl">42.0</span>, <span class="fl">35.6</span>, <span class="fl">3.7</span>, <span class="fl">4.9</span>, <span class="fl">9.3</span>, <span class="fl">42.0</span>, <span class="fl">8.6</span>)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>periodico <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">69.2</span>, <span class="fl">45.1</span>, <span class="fl">69.3</span>, <span class="fl">58.5</span>, <span class="fl">58.4</span>, <span class="fl">75.0</span>, <span class="fl">23.5</span>, <span class="fl">11.6</span>, <span class="fl">1.0</span>, <span class="fl">21.2</span>, <span class="fl">24.2</span>,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>               <span class="fl">4.0</span>, <span class="fl">65.9</span>, <span class="fl">7.2</span>, <span class="fl">46.0</span>, <span class="fl">52.9</span>, <span class="fl">114.0</span>, <span class="fl">55.8</span>, <span class="fl">18.3</span>, <span class="fl">19.1</span>, <span class="fl">53.4</span>, <span class="fl">23.5</span>,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>               <span class="fl">49.6</span>, <span class="fl">26.2</span>, <span class="fl">18.3</span>, <span class="fl">19.5</span>, <span class="fl">12.6</span>, <span class="fl">22.9</span>, <span class="fl">22.9</span>, <span class="fl">40.8</span>, <span class="fl">43.2</span>, <span class="fl">38.6</span>, <span class="fl">30.0</span>,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.3</span>, <span class="fl">7.4</span>, <span class="fl">8.5</span>, <span class="fl">5.0</span>, <span class="fl">45.7</span>, <span class="fl">35.1</span>, <span class="fl">32.0</span>, <span class="fl">31.6</span>, <span class="fl">38.7</span>, <span class="fl">1.8</span>, <span class="fl">26.4</span>, <span class="fl">43.3</span>,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>               <span class="fl">31.5</span>, <span class="fl">35.7</span>, <span class="fl">18.5</span>, <span class="fl">49.9</span>, <span class="fl">36.8</span>, <span class="fl">34.6</span>, <span class="fl">3.6</span>, <span class="fl">39.6</span>, <span class="fl">58.7</span>, <span class="fl">15.9</span>, <span class="fl">60.0</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>               <span class="fl">41.4</span>, <span class="fl">16.6</span>, <span class="fl">37.7</span>, <span class="fl">9.3</span>, <span class="fl">21.4</span>, <span class="fl">54.7</span>, <span class="fl">27.3</span>, <span class="fl">8.4</span>, <span class="fl">28.9</span>, <span class="fl">0.9</span>, <span class="fl">2.2</span>, <span class="fl">10.2</span>,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>               <span class="fl">11.0</span>, <span class="fl">27.2</span>, <span class="fl">38.7</span>, <span class="fl">31.7</span>, <span class="fl">19.3</span>, <span class="fl">31.3</span>, <span class="fl">13.1</span>, <span class="fl">89.4</span>, <span class="fl">20.7</span>, <span class="fl">14.2</span>, <span class="fl">9.4</span>,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>               <span class="fl">23.1</span>, <span class="fl">22.3</span>, <span class="fl">36.9</span>, <span class="fl">32.5</span>, <span class="fl">35.6</span>, <span class="fl">33.8</span>, <span class="fl">65.7</span>, <span class="fl">16.0</span>, <span class="fl">63.2</span>, <span class="fl">73.4</span>, <span class="fl">51.4</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>               <span class="fl">9.3</span>, <span class="fl">33.0</span>, <span class="fl">59.0</span>, <span class="fl">72.3</span>, <span class="fl">10.9</span>, <span class="fl">52.9</span>, <span class="fl">5.9</span>, <span class="fl">22.0</span>, <span class="fl">51.2</span>, <span class="fl">45.9</span>, <span class="fl">49.8</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>               <span class="fl">100.9</span>, <span class="fl">21.4</span>, <span class="fl">17.9</span>, <span class="fl">5.3</span>, <span class="fl">59.0</span>, <span class="fl">29.7</span>, <span class="fl">23.2</span>, <span class="fl">25.6</span>, <span class="fl">5.5</span>, <span class="fl">56.5</span>, <span class="fl">23.2</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>               <span class="fl">2.4</span>, <span class="fl">10.7</span>, <span class="fl">34.5</span>, <span class="fl">52.7</span>, <span class="fl">25.6</span>, <span class="fl">14.8</span>, <span class="fl">79.2</span>, <span class="fl">22.3</span>, <span class="fl">46.2</span>, <span class="fl">50.4</span>, <span class="fl">15.6</span>,</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>               <span class="fl">12.4</span>, <span class="fl">74.2</span>, <span class="fl">25.9</span>, <span class="fl">50.6</span>, <span class="fl">9.2</span>, <span class="fl">3.2</span>, <span class="fl">43.1</span>, <span class="fl">8.7</span>, <span class="fl">43.0</span>, <span class="fl">2.1</span>, <span class="fl">45.1</span>, <span class="fl">65.6</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>               <span class="fl">8.5</span>, <span class="fl">9.3</span>, <span class="fl">59.7</span>, <span class="fl">20.5</span>, <span class="fl">1.7</span>, <span class="fl">12.9</span>, <span class="fl">75.6</span>, <span class="fl">37.9</span>, <span class="fl">34.4</span>, <span class="fl">38.9</span>, <span class="fl">9.0</span>, <span class="fl">8.7</span>,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>               <span class="fl">44.3</span>, <span class="fl">11.9</span>, <span class="fl">20.6</span>, <span class="fl">37.0</span>, <span class="fl">48.7</span>, <span class="fl">14.2</span>, <span class="fl">37.7</span>, <span class="fl">9.5</span>, <span class="fl">5.7</span>, <span class="fl">50.5</span>, <span class="fl">24.3</span>,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>               <span class="fl">45.2</span>, <span class="fl">34.6</span>, <span class="fl">30.7</span>, <span class="fl">49.3</span>, <span class="fl">25.6</span>, <span class="fl">7.4</span>, <span class="fl">5.4</span>, <span class="fl">84.8</span>, <span class="fl">21.6</span>, <span class="fl">19.4</span>, <span class="fl">57.6</span>,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>               <span class="fl">6.4</span>, <span class="fl">18.4</span>, <span class="fl">47.4</span>, <span class="fl">17.0</span>, <span class="fl">12.8</span>, <span class="fl">13.1</span>, <span class="fl">41.8</span>, <span class="fl">20.3</span>, <span class="fl">35.2</span>, <span class="fl">23.7</span>, <span class="fl">17.6</span>,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>               <span class="fl">8.3</span>, <span class="fl">27.4</span>, <span class="fl">29.7</span>, <span class="fl">71.8</span>, <span class="fl">30.0</span>, <span class="fl">19.6</span>, <span class="fl">26.6</span>, <span class="fl">18.2</span>, <span class="fl">3.7</span>, <span class="fl">23.4</span>, <span class="fl">5.8</span>, <span class="fl">6.0</span>,</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>               <span class="fl">31.6</span>, <span class="fl">3.6</span>, <span class="fl">6.0</span>, <span class="fl">13.8</span>, <span class="fl">8.1</span>, <span class="fl">6.4</span>, <span class="fl">66.2</span>, <span class="fl">8.7</span>)</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>ventas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">22.1</span>, <span class="fl">10.4</span>, <span class="fl">9.3</span>, <span class="fl">18.5</span>, <span class="fl">12.9</span>, <span class="fl">7.2</span>, <span class="fl">11.8</span>, <span class="fl">13.2</span>, <span class="fl">4.8</span>, <span class="fl">10.6</span>, <span class="fl">8.6</span>, <span class="fl">17.4</span>,</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>            <span class="fl">9.2</span>, <span class="fl">9.7</span>, <span class="fl">19.0</span>, <span class="fl">22.4</span>, <span class="fl">12.5</span>, <span class="fl">24.4</span>, <span class="fl">11.3</span>, <span class="fl">14.6</span>, <span class="fl">18.0</span>, <span class="fl">12.5</span>, <span class="fl">5.6</span>, <span class="fl">15.5</span>,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>            <span class="fl">9.7</span>, <span class="fl">12.0</span>, <span class="fl">15.0</span>, <span class="fl">15.9</span>, <span class="fl">18.9</span>, <span class="fl">10.5</span>, <span class="fl">21.4</span>, <span class="fl">11.9</span>, <span class="fl">9.6</span>, <span class="fl">17.4</span>, <span class="fl">9.5</span>, <span class="fl">12.8</span>,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>            <span class="fl">25.4</span>, <span class="fl">14.7</span>, <span class="fl">10.1</span>, <span class="fl">21.5</span>, <span class="fl">16.6</span>, <span class="fl">17.1</span>, <span class="fl">20.7</span>, <span class="fl">12.9</span>, <span class="fl">8.5</span>, <span class="fl">14.9</span>, <span class="fl">10.6</span>, <span class="fl">23.2</span>,</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>            <span class="fl">14.8</span>, <span class="fl">9.7</span>, <span class="fl">11.4</span>, <span class="fl">10.7</span>, <span class="fl">22.6</span>, <span class="fl">21.2</span>, <span class="fl">20.2</span>, <span class="fl">23.7</span>, <span class="fl">5.5</span>, <span class="fl">13.2</span>, <span class="fl">23.8</span>, <span class="fl">18.4</span>,</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>            <span class="fl">8.1</span>, <span class="fl">24.2</span>, <span class="fl">15.7</span>, <span class="fl">14.0</span>, <span class="fl">18.0</span>, <span class="fl">9.3</span>, <span class="fl">9.5</span>, <span class="fl">13.4</span>, <span class="fl">18.9</span>, <span class="fl">22.3</span>, <span class="fl">18.3</span>, <span class="fl">12.4</span>,</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>            <span class="fl">8.8</span>, <span class="fl">11.0</span>, <span class="fl">17.0</span>, <span class="fl">8.7</span>, <span class="fl">6.9</span>, <span class="fl">14.2</span>, <span class="fl">5.3</span>, <span class="fl">11.0</span>, <span class="fl">11.8</span>, <span class="fl">12.3</span>, <span class="fl">11.3</span>, <span class="fl">13.6</span>,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>            <span class="fl">21.7</span>, <span class="fl">15.2</span>, <span class="fl">12.0</span>, <span class="fl">16.0</span>, <span class="fl">12.9</span>, <span class="fl">16.7</span>, <span class="fl">11.2</span>, <span class="fl">7.3</span>, <span class="fl">19.4</span>, <span class="fl">22.2</span>, <span class="fl">11.5</span>, <span class="fl">16.9</span>,</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>            <span class="fl">11.7</span>, <span class="fl">15.5</span>, <span class="fl">25.4</span>, <span class="fl">17.2</span>, <span class="fl">11.7</span>, <span class="fl">23.8</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">20.7</span>, <span class="fl">19.2</span>, <span class="fl">7.2</span>, <span class="fl">8.7</span>,</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>            <span class="fl">5.3</span>, <span class="fl">19.8</span>, <span class="fl">13.4</span>, <span class="fl">21.8</span>, <span class="fl">14.1</span>, <span class="fl">15.9</span>, <span class="fl">14.6</span>, <span class="fl">12.6</span>, <span class="fl">12.2</span>, <span class="fl">9.4</span>, <span class="fl">15.9</span>, <span class="fl">6.6</span>,</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>            <span class="fl">15.5</span>, <span class="fl">7.0</span>, <span class="fl">11.6</span>, <span class="fl">15.2</span>, <span class="fl">19.7</span>, <span class="fl">10.6</span>, <span class="fl">6.6</span>, <span class="fl">8.8</span>, <span class="fl">24.7</span>, <span class="fl">9.7</span>, <span class="fl">1.6</span>, <span class="fl">12.7</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>            <span class="fl">5.7</span>, <span class="fl">19.6</span>, <span class="fl">10.8</span>, <span class="fl">11.6</span>, <span class="fl">9.5</span>, <span class="fl">20.8</span>, <span class="fl">9.6</span>, <span class="fl">20.7</span>, <span class="fl">10.9</span>, <span class="fl">19.2</span>, <span class="fl">20.1</span>, <span class="fl">10.4</span>,</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>            <span class="fl">11.4</span>, <span class="fl">10.3</span>, <span class="fl">13.2</span>, <span class="fl">25.4</span>, <span class="fl">10.9</span>, <span class="fl">10.1</span>, <span class="fl">16.1</span>, <span class="fl">11.6</span>, <span class="fl">16.6</span>, <span class="fl">19.0</span>, <span class="fl">15.6</span>,</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>            <span class="fl">3.2</span>, <span class="fl">15.3</span>, <span class="fl">10.1</span>, <span class="fl">7.3</span>, <span class="fl">12.9</span>, <span class="fl">14.4</span>, <span class="fl">13.3</span>, <span class="fl">14.9</span>, <span class="fl">18.0</span>, <span class="fl">11.9</span>, <span class="fl">11.9</span>, <span class="fl">8.0</span>,</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>            <span class="fl">12.2</span>, <span class="fl">17.1</span>, <span class="fl">15.0</span>, <span class="fl">8.4</span>, <span class="fl">14.5</span>, <span class="fl">7.6</span>, <span class="fl">11.7</span>, <span class="fl">11.5</span>, <span class="fl">27.0</span>, <span class="fl">20.2</span>, <span class="fl">11.7</span>, <span class="fl">11.8</span>,</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>            <span class="fl">12.6</span>, <span class="fl">10.5</span>, <span class="fl">12.2</span>, <span class="fl">8.7</span>, <span class="fl">26.2</span>, <span class="fl">17.6</span>, <span class="fl">22.6</span>, <span class="fl">10.3</span>, <span class="fl">17.3</span>, <span class="fl">15.9</span>, <span class="fl">6.7</span>, <span class="fl">10.8</span>,</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>            <span class="fl">9.9</span>, <span class="fl">5.9</span>, <span class="fl">19.6</span>, <span class="fl">17.3</span>, <span class="fl">7.6</span>, <span class="fl">9.7</span>, <span class="fl">12.8</span>, <span class="fl">25.5</span>, <span class="fl">13.4</span>)</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tv, radio, periodico, ventas)</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     tv radio periodico ventas
1 230.1  37.8      69.2   22.1
2  44.5  39.3      45.1   10.4
3  17.2  45.9      69.3    9.3
4 151.5  41.3      58.5   18.5
5 180.8  10.8      58.4   12.9
6   8.7  48.9      75.0    7.2</code></pre>
</div>
</div>
</section>
<section id="correlaciones-y-multicolinealidad" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="correlaciones-y-multicolinealidad"><span class="header-section-number">3.2</span> Correlaciones y multicolinealidad</h2>
<p>Primero, miramos las correlaciones entre variables:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(datos)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/corr-publicidad-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">cor</span>(datos)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  tv      radio  periodico    ventas
tv        1.00000000 0.05480866 0.05664787 0.7822244
radio     0.05480866 1.00000000 0.35410375 0.5762226
periodico 0.05664787 0.35410375 1.00000000 0.2282990
ventas    0.78222442 0.57622257 0.22829903 1.0000000</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(r, <span class="at">method=</span><span class="st">"circle"</span>, <span class="at">type=</span><span class="st">"lower"</span>, <span class="at">diag=</span><span class="cn">FALSE</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col=</span><span class="st">"black"</span>, <span class="at">tl.cex=</span><span class="fl">0.8</span>, <span class="at">tl.srt=</span><span class="dv">45</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/corr-publicidad-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Interpretación:</p>
<ul>
<li>La columna <strong>ventas</strong> te muestra cómo se relaciona la variable respuesta con cada medio.<br>
</li>
<li>Si dos regresores (por ejemplo, <code>tv</code> y <code>radio</code>) tienen <strong>correlación muy alta</strong>, podría haber multicolinealidad.<br>
</li>
<li>El <code>corrplot</code> ayuda a ver estas relaciones de forma más clara que solo con la matriz numérica.</li>
</ul>
</div>
</div>
</section>
<section id="modelo-con-las-tres-variables" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="modelo-con-las-tres-variables"><span class="header-section-number">3.3</span> Modelo con las tres variables</h2>
<p>Ajustamos el modelo completo:</p>
<p><span class="math display">\[
\text{ventas} = \beta_0 + \beta_1 \text{tv} + \beta_2 \text{radio} + \beta_3 \text{periodico} + \varepsilon
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>modelo_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(ventas <span class="sc">~</span> tv <span class="sc">+</span> radio <span class="sc">+</span> periodico, <span class="at">data =</span> datos)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_full)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ventas ~ tv + radio + periodico, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.8277 -0.8908  0.2418  1.1893  2.8292 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.938889   0.311908   9.422   &lt;2e-16 ***
tv           0.045765   0.001395  32.809   &lt;2e-16 ***
radio        0.188530   0.008611  21.893   &lt;2e-16 ***
periodico   -0.001037   0.005871  -0.177     0.86    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.686 on 196 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8956 
F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mira especialmente:</p>
<ul>
<li>El <strong>p-value</strong> de cada coeficiente → te indica si esa variable es significativa.<br>
</li>
<li>El <strong>p-value</strong> de la prueba F → si el modelo completo explica significativamente a <code>ventas</code>.<br>
</li>
<li>El <strong>R^2</strong> y <strong>R^2 ajustado</strong> → qué porcentaje de la variación se explica por los regresores.</li>
</ul>
</div>
</div>
</section>
<section id="modelo-sin-variable-no-significativa" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="modelo-sin-variable-no-significativa"><span class="header-section-number">3.4</span> Modelo sin variable no significativa</h2>
<p>Si el coeficiente de <code>periodico</code> no es significativo, podemos intentar un modelo más parsimonioso:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(ventas <span class="sc">~</span> tv <span class="sc">+</span> radio, <span class="at">data =</span> datos)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ventas ~ tv + radio, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.7977 -0.8752  0.2422  1.1708  2.8328 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.92110    0.29449   9.919   &lt;2e-16 ***
tv           0.04575    0.00139  32.909   &lt;2e-16 ***
radio        0.18799    0.00804  23.382   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.681 on 197 degrees of freedom
Multiple R-squared:  0.8972,    Adjusted R-squared:  0.8962 
F-statistic: 859.6 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Eliminar variables no significativas:</p>
<ul>
<li>Simplifica la interpretación.<br>
</li>
<li>Puede mejorar la capacidad predictiva fuera de muestra.<br>
</li>
<li>Siempre es recomendable comparar modelos (por ejemplo, con ANOVA o criterios de información).</li>
</ul>
</div>
</div>
</section>
<section id="superficie-de-regresión-en-3d" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="superficie-de-regresión-en-3d"><span class="header-section-number">3.5</span> Superficie de regresión en 3D</h2>
<p>Como ahora el modelo solo depende de <strong>tv</strong> y <strong>radio</strong>, podemos visualizar la “superficie de regresión” y cómo se ubican los datos alrededor de ella.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rango_tv <span class="ot">&lt;-</span> <span class="fu">range</span>(datos<span class="sc">$</span>tv)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>nuevos_valores_tv <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> rango_tv[<span class="dv">1</span>], <span class="at">to =</span> rango_tv[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>rango_radio <span class="ot">&lt;-</span> <span class="fu">range</span>(datos<span class="sc">$</span>radio)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>nuevos_valores_radio <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> rango_radio[<span class="dv">1</span>], <span class="at">to =</span> rango_radio[<span class="dv">2</span>],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>predicciones <span class="ot">&lt;-</span> <span class="fu">outer</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> nuevos_valores_tv,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> nuevos_valores_radio, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(tv, radio) {</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(<span class="at">object =</span> modelo, <span class="at">newdata =</span> <span class="fu">data.frame</span>(tv, radio))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>superficie <span class="ot">&lt;-</span> <span class="fu">persp</span>(</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> nuevos_valores_tv,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> nuevos_valores_radio,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> predicciones,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> <span class="dv">18</span>, <span class="at">phi =</span> <span class="dv">20</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">shade =</span> <span class="fl">0.1</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tv"</span>, <span class="at">ylab =</span> <span class="st">"radio"</span>, <span class="at">zlab =</span> <span class="st">"ventas"</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción ventas ~ tv + radio"</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>observaciones <span class="ot">&lt;-</span> <span class="fu">trans3d</span>(datos<span class="sc">$</span>tv, datos<span class="sc">$</span>radio, datos<span class="sc">$</span>ventas, superficie)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">trans3d</span>(datos<span class="sc">$</span>tv, datos<span class="sc">$</span>radio, <span class="fu">fitted</span>(modelo), superficie)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(observaciones, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(observaciones<span class="sc">$</span>x, observaciones<span class="sc">$</span>y, error<span class="sc">$</span>x, error<span class="sc">$</span>y)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/superficie-simple-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Los puntos rojos son las <strong>observaciones reales</strong>.<br>
</li>
<li>Las líneas verticales muestran la <strong>distancia</strong> entre la superficie de predicción y los datos → son los errores del modelo.<br>
</li>
<li>Si las líneas son pequeñas, el ajuste es bueno.</li>
</ul>
</div>
</div>
</section>
<section id="análisis-de-residuos-del-modelo-reducido" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="análisis-de-residuos-del-modelo-reducido"><span class="header-section-number">3.6</span> Análisis de residuos del modelo reducido</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo$residuals
W = 0.91804, p-value = 4.19e-09</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo<span class="sc">$</span>residuals, <span class="at">main=</span><span class="st">"Histograma de residuos"</span>, <span class="at">xlab=</span><span class="st">"Residuo"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-modelo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo<span class="sc">$</span>residuals), <span class="at">main=</span><span class="st">"Densidad de residuos"</span>, <span class="at">xlab=</span><span class="st">"Residuo"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-modelo-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pruebas de autocorrelación y heterocedasticidad:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(modelo, <span class="at">alternative =</span><span class="st">"two.sided"</span>, <span class="at">iterations =</span> <span class="dv">1000</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  modelo
DW = 2.0808, p-value = 0.5656
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo
BP = 4.8093, df = 2, p-value = 0.0903</code></pre>
</div>
</div>
<p>Gráfico de valores reales vs estimados:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo<span class="sc">$</span>fitted.values, datos<span class="sc">$</span>ventas,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Ventas estimadas"</span>, <span class="at">ylab =</span> <span class="st">"Ventas reales"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Ventas reales vs estimadas (modelo sin periodico)"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/reales-vs-ajustados-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Si los puntos se alinean alrededor de la diagonal roja → el modelo predice razonablemente bien.<br>
</li>
<li>Desviaciones sistemáticas o patrones curvos indicarían que falta estructura (no linealidad, interacciones, etc.).</li>
</ul>
</div>
</div>
</section>
<section id="incorporar-una-interacción-tv-radio" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="incorporar-una-interacción-tv-radio"><span class="header-section-number">3.7</span> Incorporar una interacción tv * radio</h2>
<p>Ahora probamos un modelo donde el efecto de la TV <strong>depende del nivel de radio</strong> (y viceversa).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tv_radio <span class="ot">&lt;-</span> tv <span class="sc">*</span> radio</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>modelo_interaccion <span class="ot">&lt;-</span> <span class="fu">lm</span>(ventas <span class="sc">~</span> tv <span class="sc">+</span> radio <span class="sc">+</span> tv<span class="sc">:</span>radio, <span class="at">data =</span> datos)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_interaccion)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ventas ~ tv + radio + tv:radio, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3366 -0.4028  0.1831  0.5948  1.5246 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 6.750e+00  2.479e-01  27.233   &lt;2e-16 ***
tv          1.910e-02  1.504e-03  12.699   &lt;2e-16 ***
radio       2.886e-02  8.905e-03   3.241   0.0014 ** 
tv:radio    1.086e-03  5.242e-05  20.727   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9435 on 196 degrees of freedom
Multiple R-squared:  0.9678,    Adjusted R-squared:  0.9673 
F-statistic:  1963 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Analizamos los residuos del nuevo modelo:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_interaccion<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_interaccion$residuals
W = 0.8469, p-value = 3.047e-13</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo_interaccion<span class="sc">$</span>residuals, <span class="at">main=</span><span class="st">"Histograma residuos modelo interacción"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-interaccion-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo_interaccion<span class="sc">$</span>residuals),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Densidad residuos modelo interacción"</span>, <span class="at">xlab=</span><span class="st">"Residuo"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-interaccion-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(modelo_interaccion, <span class="at">alternative =</span><span class="st">"two.sided"</span>, <span class="at">iterations =</span> <span class="dv">1000</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  modelo_interaccion
DW = 2.2236, p-value = 0.1103
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo_interaccion)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo_interaccion
BP = 14.324, df = 3, p-value = 0.002495</code></pre>
</div>
</div>
<p>Ventas reales vs estimadas con interacción:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_interaccion<span class="sc">$</span>fitted.values, datos<span class="sc">$</span>ventas,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Ventas estimadas"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ventas reales"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Ventas reales vs estimadas (modelo con interacción)"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/reales-vs-ajustados-interaccion-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="superficie-del-modelo-con-interacción" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="superficie-del-modelo-con-interacción"><span class="header-section-number">3.8</span> Superficie del modelo con interacción</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>rango_tv <span class="ot">&lt;-</span> <span class="fu">range</span>(datos<span class="sc">$</span>tv)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>nuevos_valores_tv <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> rango_tv[<span class="dv">1</span>], <span class="at">to =</span> rango_tv[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>rango_radio <span class="ot">&lt;-</span> <span class="fu">range</span>(datos<span class="sc">$</span>radio)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>nuevos_valores_radio <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> rango_radio[<span class="dv">1</span>], <span class="at">to =</span> rango_radio[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>predicciones <span class="ot">&lt;-</span> <span class="fu">outer</span>(</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> nuevos_valores_tv,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> nuevos_valores_radio, </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(tv, radio) {</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(<span class="at">object =</span> modelo_interaccion,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">newdata =</span> <span class="fu">data.frame</span>(tv, radio))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>superficie <span class="ot">&lt;-</span> <span class="fu">persp</span>(</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> nuevos_valores_tv,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> nuevos_valores_radio,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> predicciones,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> <span class="dv">18</span>, <span class="at">phi =</span> <span class="dv">20</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">shade =</span> <span class="fl">0.1</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tv"</span>, <span class="at">ylab =</span> <span class="st">"radio"</span>, <span class="at">zlab =</span> <span class="st">"ventas"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ticktype =</span> <span class="st">"detailed"</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción ventas ~ tv + radio + tv:radio"</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>observaciones <span class="ot">&lt;-</span> <span class="fu">trans3d</span>(datos<span class="sc">$</span>tv, datos<span class="sc">$</span>radio, datos<span class="sc">$</span>ventas, superficie)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">trans3d</span>(datos<span class="sc">$</span>tv, datos<span class="sc">$</span>radio, <span class="fu">fitted</span>(modelo_interaccion), superficie)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(observaciones, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(observaciones<span class="sc">$</span>x, observaciones<span class="sc">$</span>y, error<span class="sc">$</span>x, error<span class="sc">$</span>y)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/superficie-interaccion-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparación-de-modelos-con-anova" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="comparación-de-modelos-con-anova"><span class="header-section-number">3.9</span> Comparación de modelos con ANOVA</h2>
<p>Comparamos el modelo sin interacción y el modelo con interacción:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo, modelo_interaccion)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: ventas ~ tv + radio
Model 2: ventas ~ tv + radio + tv:radio
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    197 556.91                                  
2    196 174.48  1    382.43 429.59 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Si la prueba ANOVA da un <strong>p-value pequeño</strong>, la interacción aporta información estadísticamente significativa.<br>
</li>
<li>Además de la significancia, es importante revisar residuos y lógica económica del modelo.</li>
</ul>
</div>
</div>
</section>
<section id="modelo-con-interacción-y-término-cuadrático-en-tv" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="modelo-con-interacción-y-término-cuadrático-en-tv"><span class="header-section-number">3.10</span> Modelo con interacción y término cuadrático en tv</h2>
<p>Probamos un modelo más flexible:</p>
<p><span class="math display">\[
\text{ventas} = \beta_0 + \beta_1 \text{tv} + \beta_2 \text{radio} + \beta_3 \text{tv}^2 + \beta_4 (\text{tv}\cdot\text{radio}) + \varepsilon
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>modelo_interaccion_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ventas <span class="sc">~</span> tv <span class="sc">+</span> radio <span class="sc">+</span> <span class="fu">I</span>(tv<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> tv<span class="sc">:</span>radio, <span class="at">data =</span> datos)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_interaccion_1)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ventas ~ tv + radio + I(tv^2) + tv:radio, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.9949 -0.2969 -0.0066  0.3798  1.1686 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.137e+00  1.927e-01  26.663  &lt; 2e-16 ***
tv           5.092e-02  2.232e-03  22.810  &lt; 2e-16 ***
radio        3.516e-02  5.901e-03   5.959 1.17e-08 ***
I(tv^2)     -1.097e-04  6.893e-06 -15.920  &lt; 2e-16 ***
tv:radio     1.077e-03  3.466e-05  31.061  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6238 on 195 degrees of freedom
Multiple R-squared:  0.986, Adjusted R-squared:  0.9857 
F-statistic:  3432 on 4 and 195 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_interaccion_1<span class="sc">$</span>fitted.values, datos<span class="sc">$</span>ventas,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Ventas estimadas"</span>, <span class="at">ylab =</span> <span class="st">"Ventas reales"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Ventas reales vs estimadas (modelo con tv^2 e interacción)"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">27</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">27</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-interaccion-cuadratico-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo_interaccion_1<span class="sc">$</span>residuals, <span class="at">main=</span><span class="st">"Histograma residuos modelo_interaccion_1"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-interaccion-cuadratico-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo_interaccion_1<span class="sc">$</span>residuals),</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Densidad residuos modelo_interaccion_1"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-interaccion-cuadratico-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_interaccion_1<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_interaccion_1$residuals
W = 0.80888, p-value = 6.359e-15</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(modelo_interaccion_1, <span class="at">alternative =</span><span class="st">"two.sided"</span>, <span class="at">iterations =</span> <span class="dv">1000</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  modelo_interaccion_1
DW = 2.204, p-value = 0.1432
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo_interaccion_1)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo_interaccion_1
BP = 19.986, df = 4, p-value = 0.0005027</code></pre>
</div>
</div>
</section>
</section>
<section id="parte-2-regresión-polinomial-y-transformaciones-ejemplo-de-millaje" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Parte 2: Regresión polinomial y transformaciones (ejemplo de millaje)</h1>
<p>En esta parte trabajamos con el archivo <code>millaje.txt</code>, que contiene información de autos:</p>
<ul>
<li><code>mpg</code>: millas por galón (consumo).<br>
</li>
<li><code>hp</code>: horsepower (potencia del motor).<br>
</li>
<li><code>vol</code>: alguna medida de volumen/cilindrada del motor.</li>
</ul>
<p>Queremos modelar el <strong>consumo de combustible</strong> (<code>mpg</code>) en función de la potencia (<code>hp</code>) y otras características, usando polinomios y transformaciones.</p>
<section id="cargar-los-datos-de-millaje" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="cargar-los-datos-de-millaje"><span class="header-section-number">4.1</span> Cargar los datos de millaje</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>archivo_millaje <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ruta_datos, <span class="st">"millaje.txt"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>millaje <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> archivo_millaje, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(millaje)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   mpg  sp   wt vol hp
1 65.4  96 17.5  89 49
2 56.0  97 20.0  92 55
3 55.9  97 20.0  92 55
4 49.0 105 20.0  92 70
5 46.5  96 20.0  92 53
6 46.2 105 20.0  89 70</code></pre>
</div>
</div>
</section>
<section id="correlaciones-y-gráficos" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="correlaciones-y-gráficos"><span class="header-section-number">4.2</span> Correlaciones y gráficos</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>r_auto <span class="ot">&lt;-</span> <span class="fu">cor</span>(millaje)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>r_auto</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           mpg          sp         wt         vol          hp
mpg  1.0000000 -0.68844623 -0.9050849 -0.36861368 -0.78985635
sp  -0.6884462  1.00000000  0.6785339 -0.04306242  0.96654517
wt  -0.9050849  0.67853388  1.0000000  0.38495423  0.83222021
vol -0.3686137 -0.04306242  0.3849542  1.00000000  0.07647905
hp  -0.7898564  0.96654517  0.8322202  0.07647905  1.00000000</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(millaje)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/corr-millaje-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(r_auto, <span class="at">method=</span><span class="st">"circle"</span>, <span class="at">type=</span><span class="st">"lower"</span>, <span class="at">diag=</span><span class="cn">FALSE</span>,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col=</span><span class="st">"black"</span>, <span class="at">tl.cex=</span><span class="fl">0.8</span>, <span class="at">tl.srt=</span><span class="dv">45</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/corr-millaje-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Gráfico simple de <code>mpg</code> vs <code>hp</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> millaje<span class="sc">$</span>hp,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> millaje<span class="sc">$</span>mpg,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Consumo vs potencia motor"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"hp (potencia)"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"mpg (millas por galón)"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"grey"</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/scatter-hp-mpg-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-simple-en-hp-y-vol" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="modelo-lineal-simple-en-hp-y-vol"><span class="header-section-number">4.3</span> Modelo lineal simple en hp y vol</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>modelo_lineal <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> vol, <span class="at">data =</span> millaje)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_lineal)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + vol, data = millaje)

Residuals:
    Min      1Q  Median      3Q     Max 
-10.556  -3.411  -0.687   2.736  21.058 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 63.40255    2.91066  21.783  &lt; 2e-16 ***
hp          -0.13485    0.01052 -12.818  &lt; 2e-16 ***
vol         -0.13993    0.02698  -5.187 1.61e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.366 on 79 degrees of freedom
Multiple R-squared:  0.7194,    Adjusted R-squared:  0.7123 
F-statistic: 101.3 on 2 and 79 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Visualizamos la recta de regresión en función de <code>hp</code> (manteniendo fijo <code>vol</code> en el promedio, de manera implícita):</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> millaje<span class="sc">$</span>hp,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> millaje<span class="sc">$</span>mpg,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Consumo vs potencia motor (modelo lineal)"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"hp"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"mpg"</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch  =</span> <span class="dv">20</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col  =</span> <span class="st">"grey"</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(modelo_lineal, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/linea-simple-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Este gráfico es más ilustrativo que riguroso (porque el modelo usa también <code>vol</code>), pero sirve para visualizar la tendencia lineal negativa: a mayor <code>hp</code>, menor <code>mpg</code>.</p>
</div>
</div>
</section>
<section id="modelo-polinomial-cuadrático" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="modelo-polinomial-cuadrático"><span class="header-section-number">4.4</span> Modelo polinomial cuadrático</h2>
<p>Ahora permitimos una relación <strong>no lineal</strong> entre <code>hp</code> y <code>mpg</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> vol <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> millaje)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ vol + hp + I(hp^2), data = millaje)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.4677 -2.9686 -0.6293  2.3102 15.0791 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 73.3557314  2.8205235  26.008  &lt; 2e-16 ***
vol         -0.0546235  0.0255711  -2.136   0.0358 *  
hp          -0.4115233  0.0436316  -9.432 1.57e-14 ***
I(hp^2)      0.0008294  0.0001283   6.466 8.01e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.357 on 78 degrees of freedom
Multiple R-squared:  0.8173,    Adjusted R-squared:  0.8103 
F-statistic: 116.3 on 3 and 78 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>modelo_cuadratico <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(hp, <span class="dv">2</span>), <span class="at">data =</span> millaje)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_cuadratico)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ poly(hp, 2), data = millaje)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.2059 -3.3067 -0.4611  2.4724 14.3716 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   33.7817     0.4919  68.674  &lt; 2e-16 ***
poly(hp, 2)1 -71.1198     4.4545 -15.966  &lt; 2e-16 ***
poly(hp, 2)2  38.4953     4.4545   8.642 4.87e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.454 on 79 degrees of freedom
Multiple R-squared:  0.8067,    Adjusted R-squared:  0.8018 
F-statistic: 164.8 on 2 and 79 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Comparación gráfico predicho vs real:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol2<span class="sc">$</span>fitted.values, millaje<span class="sc">$</span>mpg,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"mpg estimado"</span>, <span class="at">ylab =</span> <span class="st">"mpg real"</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Ajuste modelo polinomial (grado 2)"</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>), <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/ajuste-pol2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análisis-de-residuos-del-modelo-polinomial" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="análisis-de-residuos-del-modelo-polinomial"><span class="header-section-number">4.5</span> Análisis de residuos del modelo polinomial</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol2<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol2$residuals
W = 0.95926, p-value = 0.0107</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo_pol2<span class="sc">$</span>residuals, <span class="at">main=</span><span class="st">"Histograma residuos modelo_pol2"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-pol2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo_pol2<span class="sc">$</span>residuals),</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Densidad residuos modelo_pol2"</span>, <span class="at">xlab=</span><span class="st">"Residuo"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-pol2-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-pol2-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Comparación formal entre el modelo lineal y el polinomial:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo_lineal, modelo_pol2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: mpg ~ hp + vol
Model 2: mpg ~ vol + hp + I(hp^2)
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     79 2274.8                                  
2     78 1480.9  1    793.86 41.813 8.009e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Si el p-valor es pequeño, el término cuadrático mejora significativamente el modelo.</p>
</section>
<section id="curva-predicha-del-modelo-polinomial" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="curva-predicha-del-modelo-polinomial"><span class="header-section-number">4.6</span> Curva predicha del modelo polinomial</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> millaje<span class="sc">$</span>hp,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> millaje<span class="sc">$</span>mpg,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Consumo vs potencia motor (modelo cuadrático)"</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"hp"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"mpg"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch  =</span> <span class="dv">20</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col  =</span> <span class="st">"grey"</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>puntos_interpolados <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(millaje<span class="sc">$</span>hp), <span class="at">to =</span> <span class="fu">max</span>(millaje<span class="sc">$</span>hp), <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> modelo_pol2,</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">hp =</span> millaje<span class="sc">$</span>hp, <span class="at">vol =</span> millaje<span class="sc">$</span>vol)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">sort</span>(millaje<span class="sc">$</span>hp), prediccion[<span class="fu">order</span>(millaje<span class="sc">$</span>hp)],</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/curva-pol2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualización-con-ggplot2" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="visualización-con-ggplot2"><span class="header-section-number">4.7</span> Visualización con ggplot2</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(millaje, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Consumo vs potencia motor (modelo cuadrático)"</span>) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/ggplot-pol2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="polinomios-de-grados-más-altos" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="polinomios-de-grados-más-altos"><span class="header-section-number">4.8</span> Polinomios de grados más altos</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(millaje, <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>),  <span class="at">colour =</span> <span class="st">"red"</span>,   <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">5</span>),  <span class="at">colour =</span> <span class="st">"blue"</span>,  <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">10</span>), <span class="at">colour =</span> <span class="st">"green"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Polinomios de grados 2, 5 y 10"</span>) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/ggplot-polinomios-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Observa cómo los polinomios de grados más altos se ajustan fuertemente a los datos, pero pueden <strong>sobreajustar</strong> (overfitting) y producir curvas muy oscilantes poco realistas.</p>
</div>
</div>
</section>
<section id="modelos-polinomiales-y-comparación" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="modelos-polinomiales-y-comparación"><span class="header-section-number">4.9</span> Modelos polinomiales y comparación</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>modelo_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(hp, <span class="dv">5</span>), <span class="at">data =</span> millaje)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_5)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ poly(hp, 5), data = millaje)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.9505 -2.5323 -0.4598  3.2027 10.9823 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   33.7817     0.4503  75.018  &lt; 2e-16 ***
poly(hp, 5)1 -71.1198     4.0778 -17.441  &lt; 2e-16 ***
poly(hp, 5)2  38.4953     4.0778   9.440 1.92e-14 ***
poly(hp, 5)3 -15.3033     4.0778  -3.753  0.00034 ***
poly(hp, 5)4   7.5552     4.0778   1.853  0.06780 .  
poly(hp, 5)5  -3.5388     4.0778  -0.868  0.38822    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.078 on 76 degrees of freedom
Multiple R-squared:  0.8441,    Adjusted R-squared:  0.8339 
F-statistic: 82.31 on 5 and 76 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>modelo_5_correjido <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> vol <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> millaje)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_5_correjido)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ vol + hp + I(hp^2) + I(hp^3), data = millaje)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.6503 -2.6022 -0.3181  2.6926 11.4477 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  9.236e+01  5.361e+00  17.229  &lt; 2e-16 ***
vol         -6.226e-02  2.345e-02  -2.655 0.009634 ** 
hp          -8.414e-01  1.135e-01  -7.410 1.38e-10 ***
I(hp^2)      3.765e-03  7.355e-04   5.119 2.20e-06 ***
I(hp^3)     -5.782e-06  1.430e-06  -4.044 0.000124 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.983 on 77 degrees of freedom
Multiple R-squared:  0.8493,    Adjusted R-squared:  0.8415 
F-statistic: 108.5 on 4 and 77 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo_cuadratico, modelo_5_correjido)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: mpg ~ poly(hp, 2)
Model 2: mpg ~ vol + hp + I(hp^2) + I(hp^3)
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     79 1567.5                                  
2     77 1221.5  2    346.02 10.906 6.758e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Análisis de residuos:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_5_correjido<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_5_correjido$residuals
W = 0.98456, p-value = 0.4319</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo_5_correjido<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">"Histograma residuos modelo_5_correjido"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-5corr-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo_5_correjido<span class="sc">$</span>residuals),</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Densidad residuos modelo_5_correjido"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-5corr-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_5_correjido<span class="sc">$</span>fitted.values, millaje<span class="sc">$</span>mpg,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"mpg estimado"</span>, <span class="at">ylab =</span> <span class="st">"mpg real"</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Ajuste modelo_5_correjido"</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>), <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">60</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/residuos-5corr-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transformaciones-de-la-variable-respuesta" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="transformaciones-de-la-variable-respuesta"><span class="header-section-number">4.10</span> Transformaciones de la variable respuesta</h2>
<p>Buscamos mejorar la normalidad de los residuos y la homocedasticidad usando transformaciones de <code>mpg</code>:</p>
<section id="transformación-logarítmica" class="level3" data-number="4.10.1">
<h3 data-number="4.10.1" class="anchored" data-anchor-id="transformación-logarítmica"><span class="header-section-number">4.10.1</span> Transformación logarítmica</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2_trans <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> mpg) <span class="sc">~</span> vol <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> millaje)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2_trans)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(1 + mpg) ~ vol + hp + I(hp^2), data = millaje)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31049 -0.06894 -0.02497  0.07082  0.33219 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.581e+00  7.376e-02  62.104  &lt; 2e-16 ***
vol         -1.846e-03  6.687e-04  -2.761  0.00718 ** 
hp          -1.011e-02  1.141e-03  -8.858 2.03e-13 ***
I(hp^2)      1.734e-05  3.354e-06   5.171 1.75e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1139 on 78 degrees of freedom
Multiple R-squared:  0.8557,    Adjusted R-squared:  0.8501 
F-statistic: 154.1 on 3 and 78 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol2_trans<span class="sc">$</span>residuals, modelo_pol2_trans<span class="sc">$</span>fitted.values,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuos vs ajustados (log(1+mpg))"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-log-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> millaje<span class="sc">$</span>mpg), modelo_pol2_trans<span class="sc">$</span>fitted.values,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Valores reales transformados vs ajustados"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-log-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol2_trans<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol2_trans$residuals
W = 0.98398, p-value = 0.4003</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo_pol2_trans<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">"Histograma residuos modelo_pol2_trans"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-log-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo_pol2_trans<span class="sc">$</span>residuals),</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Densidad residuos modelo_pol2_trans"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-log-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transformación-raíz-cuadrada" class="level3" data-number="4.10.2">
<h3 data-number="4.10.2" class="anchored" data-anchor-id="transformación-raíz-cuadrada"><span class="header-section-number">4.10.2</span> Transformación raíz cuadrada</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>modelo_pol3_trans <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">sqrt</span>(mpg) <span class="sc">~</span> vol <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> millaje)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol3_trans)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sqrt(mpg) ~ vol + hp + I(hp^2), data = millaje)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.70979 -0.22004 -0.05431  0.19640  0.95714 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  9.031e+00  2.232e-01  40.459  &lt; 2e-16 ***
vol         -5.083e-03  2.024e-03  -2.512   0.0141 *  
hp          -3.256e-02  3.453e-03  -9.429 1.59e-14 ***
I(hp^2)      6.117e-05  1.015e-05   6.027 5.21e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3448 on 78 degrees of freedom
Multiple R-squared:  0.8442,    Adjusted R-squared:  0.8383 
F-statistic: 140.9 on 3 and 78 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol3_trans<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol3_trans$residuals
W = 0.97571, p-value = 0.1217</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol3_trans<span class="sc">$</span>residuals, modelo_pol3_trans<span class="sc">$</span>fitted.values,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuos vs ajustados (sqrt(mpg))"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-sqrt-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sqrt</span>(millaje<span class="sc">$</span>mpg), modelo_pol3_trans<span class="sc">$</span>fitted.values,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"sqrt(mpg) real vs ajustado"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-sqrt-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transformación-1sqrtmpg" class="level3" data-number="4.10.3">
<h3 data-number="4.10.3" class="anchored" data-anchor-id="transformación-1sqrtmpg"><span class="header-section-number">4.10.3</span> Transformación 1/sqrt(mpg)</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>modelo_pol4_trans <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(mpg) <span class="sc">~</span> vol <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> millaje)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol4_trans)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = 1/sqrt(mpg) ~ vol + hp + I(hp^2), data = millaje)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.032371 -0.007178  0.001601  0.005842  0.044607 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.354e-02  7.154e-03  11.677  &lt; 2e-16 ***
vol          1.823e-04  6.486e-05   2.811 0.006249 ** 
hp           8.284e-04  1.107e-04   7.485 9.28e-11 ***
I(hp^2)     -1.219e-06  3.253e-07  -3.747 0.000341 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01105 on 78 degrees of freedom
Multiple R-squared:  0.8501,    Adjusted R-squared:  0.8444 
F-statistic: 147.5 on 3 and 78 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol4_trans<span class="sc">$</span>residuals, modelo_pol4_trans<span class="sc">$</span>fitted.values,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuos vs ajustados (1/sqrt(mpg))"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-inv-sqrt-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(millaje<span class="sc">$</span>mpg), modelo_pol4_trans<span class="sc">$</span>fitted.values,</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"1/sqrt(mpg) real vs ajustado"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-inv-sqrt-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol4_trans<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol4_trans$residuals
W = 0.94789, p-value = 0.002249</code></pre>
</div>
</div>
</section>
<section id="transformaciones-más-complejas" class="level3" data-number="4.10.4">
<h3 data-number="4.10.4" class="anchored" data-anchor-id="transformaciones-más-complejas"><span class="header-section-number">4.10.4</span> Transformaciones más complejas</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2_tran_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> mpg) <span class="sc">~</span> vol <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> hp) <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> millaje)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2_tran_2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(1 + mpg) ~ vol + hp + log(1 + hp) + I(hp^2), 
    data = millaje)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35624 -0.06687 -0.00430  0.07828  0.29355 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.340e+00  1.236e+00   5.937 7.87e-08 ***
vol         -2.076e-03  6.602e-04  -3.144  0.00237 ** 
hp           2.231e-03  5.630e-03   0.396  0.69297    
log(1 + hp) -8.215e-01  3.675e-01  -2.236  0.02827 *  
I(hp^2)     -2.564e-06  9.486e-06  -0.270  0.78768    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1111 on 77 degrees of freedom
Multiple R-squared:  0.8645,    Adjusted R-squared:  0.8574 
F-statistic: 122.8 on 4 and 77 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> millaje<span class="sc">$</span>mpg), modelo_pol2_tran_2<span class="sc">$</span>fitted.values,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"log(1+mpg) real vs ajustado (modelo_tran_2)"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-log-hp-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol2_tran_2<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol2_tran_2$residuals
W = 0.98972, p-value = 0.7645</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo_pol2_tran_2<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">"Histograma residuos modelo_tran_2"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-log-hp-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo_pol2_tran_2<span class="sc">$</span>residuals),</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Densidad residuos modelo_tran_2"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-log-hp-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol2_tran_2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-log-hp-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-log-hp-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-log-hp-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-log-hp-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Otro modelo más flexible:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2_tran_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> mpg) <span class="sc">~</span> hp <span class="sc">+</span> <span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>hp) <span class="sc">+</span> <span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>(hp<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> hp) <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> millaje)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2_tran_3)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(1 + mpg) ~ hp + I(1/hp) + I(1/(hp^2)) + log(1 + 
    hp) + I(hp^2), data = millaje)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33860 -0.07127 -0.01969  0.07723  0.30307 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -2.034e+01  7.517e+01  -0.271    0.787
hp          -3.355e-02  8.029e-02  -0.418    0.677
I(1/hp)      4.093e+02  1.224e+03   0.334    0.739
I(1/(hp^2)) -5.165e+03  1.705e+04  -0.303    0.763
log(1 + hp)  5.049e+00  1.558e+01   0.324    0.747
I(hp^2)      3.600e-05  7.142e-05   0.504    0.616

Residual standard error: 0.1187 on 76 degrees of freedom
Multiple R-squared:  0.8475,    Adjusted R-squared:  0.8374 
F-statistic: 84.45 on 5 and 76 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol2_tran_3<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol2_tran_3$residuals
W = 0.98744, p-value = 0.6104</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol2_tran_3)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-3-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-3-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-3-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> millaje<span class="sc">$</span>mpg), modelo_pol2_tran_3<span class="sc">$</span>fitted.values,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"log(1+mpg) real vs ajustado (modelo_tran_3)"</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.5</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.5</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-3-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelos-sin-constante-y-selección" class="level3" data-number="4.10.5">
<h3 data-number="4.10.5" class="anchored" data-anchor-id="modelos-sin-constante-y-selección"><span class="header-section-number">4.10.5</span> Modelos sin constante y selección</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2_tran_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> mpg) <span class="sc">~</span> hp <span class="sc">+</span> <span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>hp) <span class="sc">+</span> <span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>(hp<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> hp) <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> millaje)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2_tran_4)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(1 + mpg) ~ hp + I(1/hp) + I(1/(hp^2)) + log(1 + 
    hp) + I(hp^2) - 1, data = millaje)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.34452 -0.07355 -0.01464  0.07509  0.30562 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)  
hp          -1.202e-02  1.098e-02  -1.094   0.2772  
I(1/hp)      7.934e+01  1.074e+02   0.738   0.4625  
I(1/(hp^2)) -6.299e+02  3.147e+03  -0.200   0.8419  
log(1 + hp)  8.319e-01  3.658e-01   2.274   0.0258 *
I(hp^2)      1.725e-05  1.732e-05   0.996   0.3223  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1179 on 77 degrees of freedom
Multiple R-squared:  0.9989,    Adjusted R-squared:  0.9989 
F-statistic: 1.459e+04 on 5 and 77 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> millaje<span class="sc">$</span>mpg), modelo_pol2_tran_4<span class="sc">$</span>fitted.values,</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Modelo_tran_4 (sin constante)"</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.5</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.5</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-sin-constante-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2_tran_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> mpg) <span class="sc">~</span> hp <span class="sc">+</span> <span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>hp) <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> hp) <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> millaje)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2_tran_5)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(1 + mpg) ~ hp + I(1/hp) + log(1 + hp) + I(hp^2) - 
    1, data = millaje)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33926 -0.07379 -0.01700  0.07535  0.30724 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
hp          -1.410e-02  3.554e-03  -3.967 0.000161 ***
I(1/hp)      5.795e+01  1.116e+01   5.194  1.6e-06 ***
log(1 + hp)  9.030e-01  8.687e-02  10.394  &lt; 2e-16 ***
I(hp^2)      2.041e-05  7.119e-06   2.867 0.005328 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1172 on 78 degrees of freedom
Multiple R-squared:  0.9989,    Adjusted R-squared:  0.9989 
F-statistic: 1.846e+04 on 4 and 78 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol2_tran_5<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol2_tran_5$residuals
W = 0.98884, p-value = 0.7058</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> millaje<span class="sc">$</span>mpg), modelo_pol2_tran_5<span class="sc">$</span>fitted.values,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Modelo_tran_5 (sin constante)"</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.5</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.5</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-sin-constante-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol2_tran_5)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-sin-constante-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-sin-constante-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-sin-constante-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelos-sin-constante-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="un-modelo-candidato-bueno" class="level3" data-number="4.10.6">
<h3 data-number="4.10.6" class="anchored" data-anchor-id="un-modelo-candidato-bueno"><span class="header-section-number">4.10.6</span> Un modelo candidato “bueno”</h3>
<p>El script sugiere como uno de los mejores:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2_tran_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> mpg) <span class="sc">~</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> hp) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> millaje)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2_tran_6)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(1 + mpg) ~ log(1 + hp) - 1, data = millaje)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.3860 -0.3480  0.1168  0.3870  1.3059 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
log(1 + hp)  0.73870    0.01383   53.42   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5883 on 81 degrees of freedom
Multiple R-squared:  0.9724,    Adjusted R-squared:  0.9721 
F-statistic:  2854 on 1 and 81 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(modelo_pol2_tran_6<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_pol2_tran_6$residuals
W = 0.97148, p-value = 0.06443</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(modelo_pol2_tran_6<span class="sc">$</span>residuals,</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histograma residuos modelo_tran_6"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-6-y-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(modelo_pol2_tran_6<span class="sc">$</span>residuals),</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Densidad residuos modelo_tran_6"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-6-y-7-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_pol2_tran_6)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-6-y-7-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-6-y-7-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-6-y-7-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab04_epg_files/figure-html/modelo-tran-6-y-7-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>modelo_pol2_tran_7 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> mpg) <span class="sc">~</span> vol <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> hp) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> millaje)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_pol2_tran_7)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(1 + mpg) ~ vol + log(1 + hp) - 1, data = millaje)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.3617 -0.3668  0.1028  0.4405  1.2853 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
vol         0.003047   0.002943   1.035    0.304    
log(1 + hp) 0.674633   0.063404  10.640   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.588 on 80 degrees of freedom
Multiple R-squared:  0.9728,    Adjusted R-squared:  0.9721 
F-statistic:  1429 on 2 and 80 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>En la práctica, al elegir entre varios modelos transformados, debes considerar:</p>
<ul>
<li>Supuestos sobre los <strong>residuos</strong> (normalidad, homocedasticidad).<br>
</li>
<li>Interpretabilidad económica de los coeficientes.<br>
</li>
<li>Capacidad predictiva (idealmente evaluada fuera de muestra).<br>
</li>
<li>Parsimonia: preferir el modelo más simple que explique bien los datos.</li>
</ul>
</div>
</div>
</section>
</section>
</section>
<section id="cierre-del-laboratorio" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Cierre del laboratorio</h1>
<p>En este laboratorio trabajaste con:</p>
<ul>
<li>Regresión múltiple con <strong>eliminación de variables irrelevantes</strong>.<br>
</li>
<li>Inclusión de <strong>interacciones</strong> y términos <strong>cuadráticos</strong>.<br>
</li>
<li>Visualizaciones 3D de superficies de regresión.<br>
</li>
<li>Modelos polinomiales de distintos grados.<br>
</li>
<li>Comparación de modelos vía <strong>ANOVA</strong>.<br>
</li>
<li>Uso de <strong>transformaciones</strong> (log, raíz, recíprocos) para mejorar los supuestos.</li>
</ul>
<p>Todo esto forma parte del “arsenal” que usarás en cursos posteriores de econometría y en aplicaciones reales para ajustar modelos más realistas y robustos</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/fen-uah\.github\.io\/lab-econometria\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 FEN-UAH</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Sitio desarrollado con Quarto</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>