<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Econometría para la Gestión (ECO_EPG) - FEN UAH">

<title>Capitulo_5 _Logit_y_otros _analisis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-360b3b5b5cb1aa80d6666be010f1eb0d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No se han encontrado resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo.png" alt="" class="navbar-logo light-content">
    <img src="../img/logo.png" alt="" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../codigos.html"> 
<span class="menu-text">Material de Estudio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../datos.html"> 
<span class="menu-text">Datos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../proyectos.html"> 
<span class="menu-text">Proyectos</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#material-descargable" id="toc-material-descargable" class="nav-link active" data-scroll-target="#material-descargable"><span class="header-section-number">1</span> 1. Material descargable</a></li>
  <li><a href="#configuración-inicial-en-r" id="toc-configuración-inicial-en-r" class="nav-link" data-scroll-target="#configuración-inicial-en-r"><span class="header-section-number">2</span> Configuración inicial en R</a>
  <ul class="collapse">
  <li><a href="#carga-de-librerías" id="toc-carga-de-librerías" class="nav-link" data-scroll-target="#carga-de-librerías"><span class="header-section-number">2.1</span> Carga de librerías</a></li>
  <li><a href="#ruta-de-trabajo-si-la-necesitas" id="toc-ruta-de-trabajo-si-la-necesitas" class="nav-link" data-scroll-target="#ruta-de-trabajo-si-la-necesitas"><span class="header-section-number">2.2</span> Ruta de trabajo (si la necesitas)</a></li>
  </ul></li>
  <li><a href="#parte-1-modelo-logit-con-datos-de-ranas-frogs" id="toc-parte-1-modelo-logit-con-datos-de-ranas-frogs" class="nav-link" data-scroll-target="#parte-1-modelo-logit-con-datos-de-ranas-frogs"><span class="header-section-number">3</span> Parte 1: Modelo Logit con datos de ranas (<code>frogs</code>)</a>
  <ul class="collapse">
  <li><a href="#exploración-inicial-de-los-datos" id="toc-exploración-inicial-de-los-datos" class="nav-link" data-scroll-target="#exploración-inicial-de-los-datos"><span class="header-section-number">3.1</span> Exploración inicial de los datos</a></li>
  <li><a href="#mapa-de-puntos-con-presenciaausencia" id="toc-mapa-de-puntos-con-presenciaausencia" class="nav-link" data-scroll-target="#mapa-de-puntos-con-presenciaausencia"><span class="header-section-number">3.2</span> Mapa de puntos con presencia/ausencia</a></li>
  <li><a href="#relación-entre-variables-explicativas" id="toc-relación-entre-variables-explicativas" class="nav-link" data-scroll-target="#relación-entre-variables-explicativas"><span class="header-section-number">3.3</span> Relación entre variables explicativas</a></li>
  <li><a href="#densidades-y-posibles-transformaciones" id="toc-densidades-y-posibles-transformaciones" class="nav-link" data-scroll-target="#densidades-y-posibles-transformaciones"><span class="header-section-number">3.4</span> Densidades y posibles transformaciones</a></li>
  <li><a href="#correlaciones-entre-variables-climáticas" id="toc-correlaciones-entre-variables-climáticas" class="nav-link" data-scroll-target="#correlaciones-entre-variables-climáticas"><span class="header-section-number">3.5</span> Correlaciones entre variables climáticas</a></li>
  <li><a href="#modelo-logit-especificación-y-ajuste" id="toc-modelo-logit-especificación-y-ajuste" class="nav-link" data-scroll-target="#modelo-logit-especificación-y-ajuste"><span class="header-section-number">3.6</span> Modelo logit: especificación y ajuste</a>
  <ul class="collapse">
  <li><a href="#modelo-logit-inicial-frogs.glm0" id="toc-modelo-logit-inicial-frogs.glm0" class="nav-link" data-scroll-target="#modelo-logit-inicial-frogs.glm0"><span class="header-section-number">3.6.1</span> Modelo logit inicial (<code>frogs.glm0</code>)</a></li>
  <li><a href="#modelo-logit-reducido-frogs.glm1" id="toc-modelo-logit-reducido-frogs.glm1" class="nav-link" data-scroll-target="#modelo-logit-reducido-frogs.glm1"><span class="header-section-number">3.6.2</span> Modelo logit reducido (<code>frogs.glm1</code>)</a></li>
  </ul></li>
  <li><a href="#tipos-de-predicción" id="toc-tipos-de-predicción" class="nav-link" data-scroll-target="#tipos-de-predicción"><span class="header-section-number">3.7</span> Tipos de predicción</a></li>
  <li><a href="#aporte-de-cada-variable-termplot" id="toc-aporte-de-cada-variable-termplot" class="nav-link" data-scroll-target="#aporte-de-cada-variable-termplot"><span class="header-section-number">3.8</span> Aporte de cada variable: <code>termplot</code></a></li>
  <li><a href="#validación-cruzada-del-modelo-logit" id="toc-validación-cruzada-del-modelo-logit" class="nav-link" data-scroll-target="#validación-cruzada-del-modelo-logit"><span class="header-section-number">3.9</span> Validación cruzada del modelo logit</a></li>
  <li><a href="#odds-ratios-or-e-intervalos-de-confianza" id="toc-odds-ratios-or-e-intervalos-de-confianza" class="nav-link" data-scroll-target="#odds-ratios-or-e-intervalos-de-confianza"><span class="header-section-number">3.10</span> Odds Ratios (OR) e intervalos de confianza</a></li>
  <li><a href="#matriz-de-confusión-y-precisión" id="toc-matriz-de-confusión-y-precisión" class="nav-link" data-scroll-target="#matriz-de-confusión-y-precisión"><span class="header-section-number">3.11</span> Matriz de confusión y precisión</a></li>
  <li><a href="#curva-roc-y-auc-con-rocr" id="toc-curva-roc-y-auc-con-rocr" class="nav-link" data-scroll-target="#curva-roc-y-auc-con-rocr"><span class="header-section-number">3.12</span> Curva ROC y AUC con <code>ROCR</code></a></li>
  </ul></li>
  <li><a href="#parte-2-modelo-logit-con-tablas-de-contingencia-y-anova-univariado" id="toc-parte-2-modelo-logit-con-tablas-de-contingencia-y-anova-univariado" class="nav-link" data-scroll-target="#parte-2-modelo-logit-con-tablas-de-contingencia-y-anova-univariado"><span class="header-section-number">4</span> Parte 2: Modelo logit con tablas de contingencia y ANOVA univariado</a>
  <ul class="collapse">
  <li><a href="#caso-ucbadmissions-logit-con-categorías" id="toc-caso-ucbadmissions-logit-con-categorías" class="nav-link" data-scroll-target="#caso-ucbadmissions-logit-con-categorías"><span class="header-section-number">4.1</span> Caso UCBAdmissions (logit con categorías)</a>
  <ul class="collapse">
  <li><a href="#modelo-logit-con-interacción-dept-gender" id="toc-modelo-logit-con-interacción-dept-gender" class="nav-link" data-scroll-target="#modelo-logit-con-interacción-dept-gender"><span class="header-section-number">4.1.1</span> Modelo logit con interacción Dept * Gender</a></li>
  </ul></li>
  <li><a href="#anova-de-un-factor-dataset-sugar" id="toc-anova-de-un-factor-dataset-sugar" class="nav-link" data-scroll-target="#anova-de-un-factor-dataset-sugar"><span class="header-section-number">4.2</span> ANOVA de un factor: dataset <code>sugar</code></a>
  <ul class="collapse">
  <li><a href="#ajuste-del-modelo-anova" id="toc-ajuste-del-modelo-anova" class="nav-link" data-scroll-target="#ajuste-del-modelo-anova"><span class="header-section-number">4.2.1</span> Ajuste del modelo ANOVA</a></li>
  <li><a href="#medias-y-comparaciones-múltiples-tukey" id="toc-medias-y-comparaciones-múltiples-tukey" class="nav-link" data-scroll-target="#medias-y-comparaciones-múltiples-tukey"><span class="header-section-number">4.2.2</span> Medias y comparaciones múltiples (Tukey)</a></li>
  </ul></li>
  <li><a href="#anova-de-dos-factores-appletaste" id="toc-anova-de-dos-factores-appletaste" class="nav-link" data-scroll-target="#anova-de-dos-factores-appletaste"><span class="header-section-number">4.3</span> ANOVA de dos factores: <code>appletaste</code></a>
  <ul class="collapse">
  <li><a href="#anova-con-panelista-y-producto" id="toc-anova-con-panelista-y-producto" class="nav-link" data-scroll-target="#anova-con-panelista-y-producto"><span class="header-section-number">4.3.1</span> ANOVA con panelista y producto</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#parte-3-manova-y-análisis-multivariante-con-datos-de-ratas" id="toc-parte-3-manova-y-análisis-multivariante-con-datos-de-ratas" class="nav-link" data-scroll-target="#parte-3-manova-y-análisis-multivariante-con-datos-de-ratas"><span class="header-section-number">5</span> Parte 3: MANOVA y análisis multivariante con datos de ratas</a>
  <ul class="collapse">
  <li><a href="#generar-el-dataset" id="toc-generar-el-dataset" class="nav-link" data-scroll-target="#generar-el-dataset"><span class="header-section-number">5.1</span> Generar el dataset</a></li>
  <li><a href="#boxplots-exploratorios" id="toc-boxplots-exploratorios" class="nav-link" data-scroll-target="#boxplots-exploratorios"><span class="header-section-number">5.2</span> Boxplots exploratorios</a></li>
  <li><a href="#estadísticos-agrupados-media-n-sd" id="toc-estadísticos-agrupados-media-n-sd" class="nav-link" data-scroll-target="#estadísticos-agrupados-media-n-sd"><span class="header-section-number">5.3</span> Estadísticos agrupados (media, n, sd)</a></li>
  <li><a href="#normalidad-univariada-por-grupo" id="toc-normalidad-univariada-por-grupo" class="nav-link" data-scroll-target="#normalidad-univariada-por-grupo"><span class="header-section-number">5.4</span> Normalidad univariada por grupo</a></li>
  <li><a href="#modelos-manova" id="toc-modelos-manova" class="nav-link" data-scroll-target="#modelos-manova"><span class="header-section-number">5.5</span> Modelos MANOVA</a></li>
  <li><a href="#anova-univariados-asociados" id="toc-anova-univariados-asociados" class="nav-link" data-scroll-target="#anova-univariados-asociados"><span class="header-section-number">5.6</span> ANOVA univariados asociados</a>
  <ul class="collapse">
  <li><a href="#tamaño-de-efecto-eta-cuadrado" id="toc-tamaño-de-efecto-eta-cuadrado" class="nav-link" data-scroll-target="#tamaño-de-efecto-eta-cuadrado"><span class="header-section-number">5.6.1</span> Tamaño de efecto (eta cuadrado)</a></li>
  <li><a href="#comparaciones-múltiples-tukey-para-una-de-las-anova" id="toc-comparaciones-múltiples-tukey-para-una-de-las-anova" class="nav-link" data-scroll-target="#comparaciones-múltiples-tukey-para-una-de-las-anova"><span class="header-section-number">5.6.2</span> Comparaciones múltiples (Tukey) para una de las ANOVA</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#cierre-del-laboratorio" id="toc-cierre-del-laboratorio" class="nav-link" data-scroll-target="#cierre-del-laboratorio"><span class="header-section-number">6</span> Cierre del laboratorio</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="lab05_epg.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Capitulo_5 _Logit_y_otros _analisis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Econometría para la Gestión (ECO_EPG) - FEN UAH </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="material-descargable" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> 1. Material descargable</h1>
<p><a href="pdf_epg/Capitulo_5 _Logit_y_otros _analisis.pdf" download="true">Descargar PDF de contenidos teóricos</a></p>
<p><a href="pdf_epg/Capitulo_5.1_logit_y_probit.pdf" download="true">Descargar PDF de contenidos teóricos</a></p>
<p>El documento <strong>“Capitulo 5 Logit y otros analisis”</strong> desarrolla, entre otros, los siguientes puntos:</p>
<ul>
<li><strong>Complementos a la regresión múltiple lineal</strong>.<br>
</li>
<li><strong>Modelo Logit</strong>:
<ul>
<li>Formulación del modelo logístico para variables binarias.<br>
</li>
<li>Función logit e inversa logística.<br>
</li>
<li>Interpretación de los coeficientes como <strong>odds ratios (OR)</strong>.<br>
</li>
<li>Validación mediante matrices de confusión y partición de datos (train/test).<br>
</li>
</ul></li>
<li><strong>Análisis de la Varianza (ANOVA)</strong>:
<ul>
<li>Factores y comparación de medias.<br>
</li>
<li>Uso del test de Tukey para comparar pares de medias.<br>
</li>
</ul></li>
<li><strong>MANOVA</strong>:
<ul>
<li>Análisis de varianza con múltiples variables respuesta.<br>
</li>
<li>Supuestos de normalidad y homogeneidad de varianzas.</li>
</ul></li>
</ul>
<p>En este laboratorio llevamos esa teoría a la práctica con distintos ejemplos en R.</p>
</section>
<section id="configuración-inicial-en-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Configuración inicial en R</h1>
<section id="carga-de-librerías" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="carga-de-librerías"><span class="header-section-number">2.1</span> Carga de librerías</h2>
<p>En este capítulo usamos varias librerías especializadas:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(c(</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  "openxlsx",</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  "DAAG",</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  "ROCR",</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  "ROCit",</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  "caret",</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  "pROC",</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#  "plotROC",</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  "lattice",</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  "ggpubr",</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  "MVN",</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  "biotools",</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#  "car",</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#  "lsr",</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  "ggplot2"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#))</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)     <span class="co"># contiene datasets como frogs, sugar, appletaste, UCBAdmissions</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)     <span class="co"># curvas ROC y AUC</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCit)    <span class="co"># otra forma de construir ROC</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)    <span class="co"># matriz de confusión y métricas de clasificación</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)     <span class="co"># ROC con intervalos de confianza</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotROC)  <span class="co"># ROC con ggplot2</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)  <span class="co"># gráficos tipo trellis (para sugar, appletaste)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)   <span class="co"># boxplots lindos para datos de ratas</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)      <span class="co"># pruebas de normalidad multivariante</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biotools) <span class="co"># Box's M</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)      <span class="co"># Levene (homogeneidad de varianzas)</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsr)      <span class="co"># etaSquared (tamaño de efecto)</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="ruta-de-trabajo-si-la-necesitas" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="ruta-de-trabajo-si-la-necesitas"><span class="header-section-number">2.2</span> Ruta de trabajo (si la necesitas)</h2>
<p>En este lab la mayoría de los datos vienen de <strong>paquetes de R</strong>, no de archivos externos.<br>
Pero mantenemos la misma lógica de ruta de tu proyecto por consistencia:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ruta_datos <span class="ot">&lt;-</span> <span class="st">"C:/Users/manue/Desktop/lab-econometria/labs_epg/data_epg"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Puedes revisar qué archivos tienes ahí (opcional)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(ruta_datos)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "annos_mantenimiento.xlsx" "auto_peso_consumo.xlsx"  
 [3] "costos.xlsx"              "data_PCA_Decathlon.csv"  
 [5] "data_PCA_ExpertWine.csv"  "Ejemplo1.xlsx"           
 [7] "Ejemplo2.xlsx"            "millaje.txt"             
 [9] "orange.csv"               "tabla_ejemplo_R.xlsx"    </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="parte-1-modelo-logit-con-datos-de-ranas-frogs" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Parte 1: Modelo Logit con datos de ranas (<code>frogs</code>)</h1>
<p>En este ejemplo trabajamos con el dataset <code>frogs</code> del paquete <strong>DAAG</strong>, que registra la <strong>presencia o ausencia</strong> de una especie de rana en distintos sitios de observación, junto con variables ambientales.</p>
<ul>
<li>Variable respuesta:
<ul>
<li><code>pres.abs</code> (0 = ausencia, 1 = presencia).<br>
</li>
</ul></li>
<li>Variables explicativas:
<ul>
<li><code>distance</code>, <code>NoOfPools</code>, <code>NoOfSites</code>, <code>avrain</code>, <code>altitude</code>, <code>meanmin</code>, <code>meanmax</code>, etc.</li>
</ul></li>
</ul>
<section id="exploración-inicial-de-los-datos" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="exploración-inicial-de-los-datos"><span class="header-section-number">3.1</span> Exploración inicial de los datos</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(frogs)  <span class="co"># carga el dataset desde DAAG</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(frogs)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   212 obs. of  10 variables:
 $ pres.abs : num  1 1 1 1 1 1 1 1 1 1 ...
 $ northing : num  115 110 112 109 109 106 105 84 88 91 ...
 $ easting  : num  1047 1042 1040 1033 1032 ...
 $ altitude : num  1500 1520 1540 1590 1590 1600 1600 1560 1560 1560 ...
 $ distance : num  500 250 250 250 250 500 250 750 250 250 ...
 $ NoOfPools: num  232 66 32 9 67 12 30 13 4 14 ...
 $ NoOfSites: num  3 5 5 5 5 4 3 2 3 4 ...
 $ avrain   : num  155 158 160 165 165 ...
 $ meanmin  : num  3.57 3.47 3.4 3.2 3.2 ...
 $ meanmax  : num  14 13.8 13.6 13.2 13.2 ...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(frogs)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pres.abs northing easting altitude distance NoOfPools NoOfSites   avrain
2        1      115    1047     1500      500       232         3 155.0000
3        1      110    1042     1520      250        66         5 157.6667
4        1      112    1040     1540      250        32         5 159.6667
5        1      109    1033     1590      250         9         5 165.0000
6        1      109    1032     1590      250        67         5 165.0000
7        1      106    1018     1600      500        12         4 167.3333
   meanmin  meanmax
2 3.566667 14.00000
3 3.466667 13.80000
4 3.400000 13.60000
5 3.200000 13.16667
6 3.200000 13.16667
7 3.133333 13.06667</code></pre>
</div>
</div>
</section>
<section id="mapa-de-puntos-con-presenciaausencia" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="mapa-de-puntos-con-presenciaausencia"><span class="header-section-number">3.2</span> Mapa de puntos con presencia/ausencia</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  northing <span class="sc">~</span> easting,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> frogs,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch  =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)[frogs<span class="sc">$</span>pres.abs <span class="sc">+</span> <span class="dv">1</span>],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Metros este de puntos de referencia"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Metros norte"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-mapa-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Círculos y puntos sólidos representan sitios con <strong>ausencia/presencia</strong>.<br>
</li>
<li>Esto ayuda a ver si hay patrones espaciales (por ejemplo, la especie se concentra en ciertas zonas).</li>
</ul>
</div>
</div>
</section>
<section id="relación-entre-variables-explicativas" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="relación-entre-variables-explicativas"><span class="header-section-number">3.3</span> Relación entre variables explicativas</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(frogs[, <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">4</span>)],</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-pairs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Aquí exploramos cómo se relacionan entre sí variables ambientales como <code>distance</code>, <code>NoOfPools</code>, <code>NoOfSites</code>, <code>avrain</code>, <code>altitude</code>, <code>meanmin</code>, <code>meanmax</code>.</p>
</section>
<section id="densidades-y-posibles-transformaciones" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="densidades-y-posibles-transformaciones"><span class="header-section-number">3.4</span> Densidades y posibles transformaciones</h2>
<p>La idea es ver la distribución de algunas variables clave y pensar en transformaciones que las hagan más “amigables” para el modelo (por ejemplo, simétricas o menos sesgadas).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"distance"</span>, <span class="st">"NoOfPools"</span>, <span class="st">"NoOfSites"</span>)){</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> frogs[, nam]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(y), <span class="at">main =</span> <span class="st">""</span>, <span class="at">xlab =</span> nam)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-densidades-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"distance"</span>, <span class="st">"NoOfPools"</span>, <span class="st">"NoOfSites"</span>)){</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> frogs[, nam]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">sqrt</span>(y)), <span class="at">main =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">"sqrt("</span>, nam, <span class="st">")"</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-densidades-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(nam <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"distance"</span>, <span class="st">"NoOfPools"</span>, <span class="st">"NoOfSites"</span>)){</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> frogs[, nam]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">log</span>(y)), <span class="at">main =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">"log("</span>, nam, <span class="st">")"</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-densidades-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>En el PDF se comenta que para algunas variables conviene usar:</p>
<ul>
<li><code>log(distance)</code><br>
</li>
<li><code>log(NoOfPools)</code><br>
</li>
<li>Transformaciones sobre <code>NoOfSites</code> y combinaciones de temperaturas (<code>meanmax + meanmin</code>, <code>meanmax - meanmin</code>).</li>
</ul>
</div>
</div>
</section>
<section id="correlaciones-entre-variables-climáticas" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="correlaciones-entre-variables-climáticas"><span class="header-section-number">3.5</span> Correlaciones entre variables climáticas</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(frogs, <span class="fu">cor</span>(altitude, meanmax))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.996557</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(frogs, <span class="fu">cor</span>(<span class="fu">cbind</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  altitude,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"meanmax+meanmin"</span> <span class="ot">=</span> meanmin <span class="sc">+</span> meanmax,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"meanmax-meanmin"</span> <span class="ot">=</span> meanmin <span class="sc">-</span> meanmax</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  altitude meanmax+meanmin meanmax-meanmin
altitude         1.0000000      -0.9933266       0.9094551
meanmax+meanmin -0.9933266       1.0000000      -0.8730120
meanmax-meanmin  0.9094551      -0.8730120       1.0000000</code></pre>
</div>
</div>
<p>Y un gráfico de pares con transformaciones:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(frogs,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">pairs</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">cbind</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">log</span>(distance), <span class="fu">log</span>(NoOfPools), NoOfSites,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         avrain, altitude, meanmax <span class="sc">+</span> meanmin, meanmax <span class="sc">-</span> meanmin</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       ),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col    =</span> <span class="st">"gray"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"log(distance)"</span>, <span class="st">"log(NoOfPools)"</span>, <span class="st">"NoOfSites"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Av. rainfall"</span>, <span class="st">"altitude"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"meanmax+meanmin"</span>, <span class="st">"meanmax-meanmin"</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">panel  =</span> panel.smooth</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-pairs-transform-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="modelo-logit-especificación-y-ajuste" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="modelo-logit-especificación-y-ajuste"><span class="header-section-number">3.6</span> Modelo logit: especificación y ajuste</h2>
<p>Recordemos que un modelo logit asume:</p>
<p><span class="math display">\[
\Pr(\text{pres.abs} = 1 \mid X) = \frac{1}{1 + e^{-(X\beta)}},
\]</span></p>
<p>y que el <strong>logit</strong> de la probabilidad es lineal en las X:</p>
<p><span class="math display">\[
\log\left(\frac{p}{1-p}\right) = X\beta.
\]</span></p>
<section id="modelo-logit-inicial-frogs.glm0" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="modelo-logit-inicial-frogs.glm0"><span class="header-section-number">3.6.1</span> Modelo logit inicial (<code>frogs.glm0</code>)</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>frogs.glm0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  pres.abs <span class="sc">~</span> <span class="fu">log</span>(distance) <span class="sc">+</span> <span class="fu">log</span>(NoOfPools) <span class="sc">+</span> NoOfSites <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    avrain <span class="sc">+</span> <span class="fu">I</span>(meanmin <span class="sc">+</span> meanmax) <span class="sc">+</span> <span class="fu">I</span>(meanmin <span class="sc">-</span> meanmax),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> frogs</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frogs.glm0)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = pres.abs ~ log(distance) + log(NoOfPools) + NoOfSites + 
    avrain + I(meanmin + meanmax) + I(meanmin - meanmax), family = binomial, 
    data = frogs)

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          18.2688999 16.1381912   1.132  0.25762    
log(distance)        -0.7583198  0.2558117  -2.964  0.00303 ** 
log(NoOfPools)        0.5708953  0.2153335   2.651  0.00802 ** 
NoOfSites            -0.0036201  0.1061469  -0.034  0.97279    
avrain                0.0007003  0.0411710   0.017  0.98643    
I(meanmin + meanmax)  1.4958055  0.3153152   4.744  2.1e-06 ***
I(meanmin - meanmax)  3.8582668  1.2783921   3.018  0.00254 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 279.99  on 211  degrees of freedom
Residual deviance: 197.65  on 205  degrees of freedom
AIC: 211.65

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="modelo-logit-reducido-frogs.glm1" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="modelo-logit-reducido-frogs.glm1"><span class="header-section-number">3.6.2</span> Modelo logit reducido (<code>frogs.glm1</code>)</h3>
<p>Quitamos algunas variables para ver si un modelo más simple puede funcionar bien:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>frogs.glm1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  pres.abs <span class="sc">~</span> <span class="fu">log</span>(distance) <span class="sc">+</span> <span class="fu">log</span>(NoOfPools) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">I</span>(meanmin <span class="sc">+</span> meanmax) <span class="sc">+</span> <span class="fu">I</span>(meanmin <span class="sc">-</span> meanmax),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> frogs</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(frogs.glm1)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = pres.abs ~ log(distance) + log(NoOfPools) + I(meanmin + 
    meanmax) + I(meanmin - meanmax), family = binomial, data = frogs)

Coefficients:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           18.5268     5.2673   3.517 0.000436 ***
log(distance)         -0.7547     0.2261  -3.338 0.000844 ***
log(NoOfPools)         0.5707     0.2152   2.652 0.007999 ** 
I(meanmin + meanmax)   1.4985     0.3088   4.853 1.22e-06 ***
I(meanmin - meanmax)   3.8806     0.9002   4.311 1.63e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 279.99  on 211  degrees of freedom
Residual deviance: 197.66  on 207  degrees of freedom
AIC: 207.66

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Signo</strong> del coeficiente: indica si la variable aumenta o reduce la probabilidad de presencia.<br>
</li>
<li><strong>Magnitud</strong>: se interpreta mejor usando la exponencial (odds ratios).<br>
</li>
<li><strong>p-value</strong>: indica si la variable aporta significativamente al modelo logit.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="tipos-de-predicción" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="tipos-de-predicción"><span class="header-section-number">3.7</span> Tipos de predicción</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades ajustadas</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">fitted</span>(frogs.glm1))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2         3         4         5         6         7 
0.9416691 0.9259228 0.9029415 0.8119619 0.9314070 0.7278038 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades con predict(type = "response")</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(frogs.glm1, <span class="at">type =</span> <span class="st">"response"</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2         3         4         5         6         7 
0.9416691 0.9259228 0.9029415 0.8119619 0.9314070 0.7278038 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escala lineal del predictor (logit)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(frogs.glm1, <span class="at">type =</span> <span class="st">"link"</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        2         3         4         5         6         7 
2.7815212 2.5256832 2.2303441 1.4628085 2.6085055 0.9835086 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores ajustados en la escala lineal con errores estándar</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>pred_link <span class="ot">&lt;-</span> <span class="fu">predict</span>(frogs.glm1, <span class="at">type =</span> <span class="st">"link"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(pred_link)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 3
 $ fit           : Named num [1:212] 2.78 2.53 2.23 1.46 2.61 ...
  ..- attr(*, "names")= chr [1:212] "2" "3" "4" "5" ...
 $ se.fit        : Named num [1:212] 0.686 0.485 0.438 0.481 0.529 ...
  ..- attr(*, "names")= chr [1:212] "2" "3" "4" "5" ...
 $ residual.scale: num 1</code></pre>
</div>
</div>
</section>
<section id="aporte-de-cada-variable-termplot" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="aporte-de-cada-variable-termplot"><span class="header-section-number">3.8</span> Aporte de cada variable: <code>termplot</code></h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="at">pty =</span> <span class="st">"s"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>frogs<span class="sc">$</span>maxminSum  <span class="ot">&lt;-</span> <span class="fu">with</span>(frogs, meanmax <span class="sc">+</span> meanmin)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>frogs<span class="sc">$</span>maxminDiff <span class="ot">&lt;-</span> <span class="fu">with</span>(frogs, meanmax <span class="sc">-</span> meanmin)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>frogs.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  pres.abs <span class="sc">~</span> <span class="fu">log</span>(distance) <span class="sc">+</span> <span class="fu">log</span>(NoOfPools) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    maxminSum <span class="sc">+</span> maxminDiff,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> frogs</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">termplot</span>(frogs.glm)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-termplot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cada gráfico muestra cómo se relaciona la <strong>respuesta en escala logit</strong> con una variable, manteniendo las demás fijas. Es un análogo al “efecto parcial” de cada regresor.</p>
</div>
</div>
</section>
<section id="validación-cruzada-del-modelo-logit" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="validación-cruzada-del-modelo-logit"><span class="header-section-number">3.9</span> Validación cruzada del modelo logit</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CVbinary</span>(frogs.glm0)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Fold:  9 10 5 2 4 6 8 7 3 1
Internal estimate of accuracy = 0.778
Cross-validation estimate of accuracy = 0.783</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CVbinary</span>(frogs.glm)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Fold:  10 5 7 4 8 9 2 3 6 1
Internal estimate of accuracy = 0.778
Cross-validation estimate of accuracy = 0.783</code></pre>
</div>
</div>
<p>Estas funciones entregan estimaciones de error de clasificación usando validación cruzada, lo que ayuda a medir la capacidad predictiva del modelo.</p>
</section>
<section id="odds-ratios-or-e-intervalos-de-confianza" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="odds-ratios-or-e-intervalos-de-confianza"><span class="header-section-number">3.10</span> Odds Ratios (OR) e intervalos de confianza</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(frogs.glm))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)  log(distance) log(NoOfPools)      maxminSum     maxminDiff 
  1.112001e+08   4.701711e-01   1.769536e+00   4.474929e+00   2.063873e-02 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(frogs.glm),</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">confint</span>(frogs.glm)))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         OR        2.5 %       97.5 %
(Intercept)    1.112001e+08 5.328174e+03 5.519123e+12
log(distance)  4.701711e-01 2.964833e-01 7.226771e-01
log(NoOfPools) 1.769536e+00 1.176801e+00 2.747499e+00
maxminSum      4.474929e+00 2.514265e+00 8.487274e+00
maxminDiff     2.063873e-02 3.247202e-03 1.122666e-01</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Un OR &gt; 1 indica que una <strong>mayor</strong> X está asociada a <strong>mayor riesgo</strong> de presencia (o ser clasificado como 1).<br>
</li>
<li>Un OR &lt; 1 indica un efecto protector (menor probabilidad de presencia).</li>
</ul>
</div>
</div>
</section>
<section id="matriz-de-confusión-y-precisión" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="matriz-de-confusión-y-precisión"><span class="header-section-number">3.11</span> Matriz de confusión y precisión</h2>
<p>Primero calculamos las probabilidades y luego definimos una <strong>regla de corte</strong> (threshold) para clasificar 0/1:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>frogs<span class="sc">$</span>rankP <span class="ot">&lt;-</span> <span class="fu">predict</span>(frogs.glm, <span class="at">newdata =</span> frogs, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(frogs<span class="sc">$</span>pres.abs, frogs<span class="sc">$</span>rankP,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Presencia real (0/1)"</span>, <span class="at">ylab =</span> <span class="st">"Probabilidad estimada"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-confusion-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fitted.results <span class="ot">&lt;-</span> <span class="fu">predict</span>(frogs.glm, <span class="at">newdata =</span> frogs, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>fitted.results <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(fitted.results <span class="sc">&gt;</span> <span class="fl">0.399779</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>misClasificError <span class="ot">&lt;-</span> <span class="fu">mean</span>(fitted.results <span class="sc">!=</span> frogs<span class="sc">$</span>pres.abs)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy"</span>, <span class="dv">1</span> <span class="sc">-</span> misClasificError))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy 0.787735849056604"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>matrizConfusion <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Real =</span> frogs<span class="sc">$</span>pres.abs,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Predicho =</span> fitted.results)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>matrizConfusion</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Predicho
Real   0   1
   0 104  29
   1  16  63</code></pre>
</div>
</div>
<p>Usando <code>caret::confusionMatrix</code>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>CM_logit <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(fitted.results),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(frogs<span class="sc">$</span>pres.abs)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>CM_logit</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 104  16
         1  29  63
                                          
               Accuracy : 0.7877          
                 95% CI : (0.7265, 0.8408)
    No Information Rate : 0.6274          
    P-Value [Acc &gt; NIR] : 3.685e-07       
                                          
                  Kappa : 0.5607          
                                          
 Mcnemar's Test P-Value : 0.07364         
                                          
            Sensitivity : 0.7820          
            Specificity : 0.7975          
         Pos Pred Value : 0.8667          
         Neg Pred Value : 0.6848          
             Prevalence : 0.6274          
         Detection Rate : 0.4906          
   Detection Prevalence : 0.5660          
      Balanced Accuracy : 0.7897          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
<section id="curva-roc-y-auc-con-rocr" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="curva-roc-y-auc-con-rocr"><span class="header-section-number">3.12</span> Curva ROC y AUC con <code>ROCR</code></h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p  <span class="ot">&lt;-</span> <span class="fu">predict</span>(frogs.glm, <span class="at">newdata =</span> frogs, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">prediction</span>(p, frogs<span class="sc">$</span>pres.abs)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>prf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pr, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prf, <span class="at">main =</span> <span class="st">"Curva ROC (ROCR)"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/frogs-roc-rocr-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cutoffs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cut =</span> prf<span class="sc">@</span>alpha.values[[<span class="dv">1</span>]],</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fpr =</span> prf<span class="sc">@</span>x.values[[<span class="dv">1</span>]],</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tpr =</span> prf<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">subset</span>(cutoffs, fpr <span class="sc">&lt;=</span> <span class="fl">0.2</span>))</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        cut fpr        tpr
1       Inf   0 0.00000000
2 0.9416691   0 0.01265823
3 0.9314070   0 0.02531646
4 0.9259228   0 0.03797468
5 0.9029415   0 0.05063291
6 0.8648604   0 0.06329114</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pr, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>auc</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8499096</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="parte-2-modelo-logit-con-tablas-de-contingencia-y-anova-univariado" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Parte 2: Modelo logit con tablas de contingencia y ANOVA univariado</h1>
<p>En esta parte veremos tres ejemplos más cortos:</p>
<ol type="1">
<li>Un modelo logit usando la tabla <strong>UCBAdmissions</strong>.<br>
</li>
<li>Un ANOVA de un factor con el dataset <strong>sugar</strong>.<br>
</li>
<li>Un ANOVA de dos factores con <strong>appletaste</strong>.</li>
</ol>
<section id="caso-ucbadmissions-logit-con-categorías" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="caso-ucbadmissions-logit-con-categorías"><span class="header-section-number">4.1</span> Caso UCBAdmissions (logit con categorías)</h2>
<p><code>UCBAdmissions</code> es una tabla 2x2x6 que contiene:</p>
<ul>
<li>Admisión (Admitted / Rejected)<br>
</li>
<li>Género (Male / Female)<br>
</li>
<li>Departamento (A–F)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>UCBAdmissions</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , Dept = A

          Gender
Admit      Male Female
  Admitted  512     89
  Rejected  313     19

, , Dept = B

          Gender
Admit      Male Female
  Admitted  353     17
  Rejected  207      8

, , Dept = C

          Gender
Admit      Male Female
  Admitted  120    202
  Rejected  205    391

, , Dept = D

          Gender
Admit      Male Female
  Admitted  138    131
  Rejected  279    244

, , Dept = E

          Gender
Admit      Male Female
  Admitted   53     94
  Rejected  138    299

, , Dept = F

          Gender
Admit      Male Female
  Admitted   22     24
  Rejected  351    317</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(UCBAdmissions)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Admit
[1] "Admitted" "Rejected"

$Gender
[1] "Male"   "Female"

$Dept
[1] "A" "B" "C" "D" "E" "F"</code></pre>
</div>
</div>
<p>Construimos un <code>data.frame</code> con admitidos y rechazados:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>UCB <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(UCBAdmissions[<span class="st">"Admitted"</span>, , ])</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(UCB)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"admit"</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>UCB<span class="sc">$</span>reject <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(UCBAdmissions[<span class="st">"Rejected"</span>, , ])<span class="sc">$</span>Freq</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>UCB<span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">relevel</span>(UCB<span class="sc">$</span>Gender, <span class="at">ref =</span> <span class="st">"Male"</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>UCB<span class="sc">$</span>total <span class="ot">&lt;-</span> UCB<span class="sc">$</span>admit <span class="sc">+</span> UCB<span class="sc">$</span>reject</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>UCB<span class="sc">$</span>p     <span class="ot">&lt;-</span> UCB<span class="sc">$</span>admit <span class="sc">/</span> UCB<span class="sc">$</span>total</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(UCB)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Gender Dept admit reject total         p
1   Male    A   512    313   825 0.6206061
2 Female    A    89     19   108 0.8240741
3   Male    B   353    207   560 0.6303571
4 Female    B    17      8    25 0.6800000
5   Male    C   120    205   325 0.3692308
6 Female    C   202    391   593 0.3406408</code></pre>
</div>
</div>
<section id="modelo-logit-con-interacción-dept-gender" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="modelo-logit-con-interacción-dept-gender"><span class="header-section-number">4.1.1</span> Modelo logit con interacción Dept * Gender</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>UCB.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">~</span> Dept <span class="sc">*</span> Gender,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family  =</span> binomial,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data    =</span> UCB,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> total</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(UCB.glm, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: binomial, link: logit

Response: p

Terms added sequentially (first to last)

            Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                           11     877.06              
Dept         5   855.32         6      21.74 &lt; 2.2e-16 ***
Gender       1     1.53         5      20.20  0.215928    
Dept:Gender  5    20.20         0       0.00  0.001144 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(UCB.glm)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = p ~ Dept * Gender, family = binomial, data = UCB, 
    weights = total)

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         0.49212    0.07175   6.859 6.94e-12 ***
DeptB               0.04163    0.11319   0.368  0.71304    
DeptC              -1.02764    0.13550  -7.584 3.34e-14 ***
DeptD              -1.19608    0.12641  -9.462  &lt; 2e-16 ***
DeptE              -1.44908    0.17681  -8.196 2.49e-16 ***
DeptF              -3.26187    0.23120 -14.109  &lt; 2e-16 ***
GenderFemale        1.05208    0.26271   4.005 6.21e-05 ***
DeptB:GenderFemale -0.83205    0.51039  -1.630  0.10306    
DeptC:GenderFemale -1.17700    0.29956  -3.929 8.53e-05 ***
DeptD:GenderFemale -0.97009    0.30262  -3.206  0.00135 ** 
DeptE:GenderFemale -1.25226    0.33032  -3.791  0.00015 ***
DeptF:GenderFemale -0.86318    0.40267  -2.144  0.03206 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance:  8.7706e+02  on 11  degrees of freedom
Residual deviance: -3.4195e-14  on  0  degrees of freedom
AIC: 92.94

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(UCB.glm)<span class="sc">$</span>coef</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Estimate Std. Error     z value     Pr(&gt;|z|)
(Intercept)         0.49212143 0.07174966   6.8588682 6.940825e-12
DeptB               0.04162783 0.11318919   0.3677721 7.130431e-01
DeptC              -1.02763967 0.13549685  -7.5842331 3.344593e-14
DeptD              -1.19607953 0.12640656  -9.4621632 3.016374e-21
DeptE              -1.44908321 0.17681152  -8.1956378 2.492678e-16
DeptF              -3.26186520 0.23119594 -14.1086615 3.358928e-45
GenderFemale        1.05207596 0.26270810   4.0047336 6.208742e-05
DeptB:GenderFemale -0.83205342 0.51039480  -1.6302153 1.030560e-01
DeptC:GenderFemale -1.17699758 0.29955796  -3.9291147 8.525915e-05
DeptD:GenderFemale -0.97008876 0.30261874  -3.2056467 1.347593e-03
DeptE:GenderFemale -1.25226298 0.33032201  -3.7910371 1.500195e-04
DeptF:GenderFemale -0.86318013 0.40266653  -2.1436600 3.206014e-02</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>El modelo captura cómo la probabilidad de admisión cambia por <strong>departamento</strong> y <strong>género</strong>, incluyendo la <strong>interacción</strong> entre ambos.<br>
</li>
<li>El resultado ilustra el clásico ejemplo de <strong>sesgo aparente</strong> por género y cómo la estructura por departamentos altera la interpretación (paradoja de Simpson).</li>
</ul>
</div>
</div>
</section>
</section>
<section id="anova-de-un-factor-dataset-sugar" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="anova-de-un-factor-dataset-sugar"><span class="header-section-number">4.2</span> ANOVA de un factor: dataset <code>sugar</code></h2>
<p>Este ejemplo se centra en un <strong>diseño de tratamientos</strong> (trt) y la variable respuesta <code>weight</code> (peso).</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(sugar)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sugar)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  weight     trt
1   82.0 Control
2   97.8 Control
3   69.9 Control
4   58.3       A
5   67.9       A
6   59.3       A</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(trt <span class="sc">~</span> weight,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch  =</span> <span class="dv">0</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Weight (mg)"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> sugar,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">aspect =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/sugar-datos-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(sugar<span class="sc">$</span>trt)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Control" "A"       "B"       "C"      </code></pre>
</div>
</div>
<section id="ajuste-del-modelo-anova" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="ajuste-del-modelo-anova"><span class="header-section-number">4.2.1</span> Ajuste del modelo ANOVA</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>sugar.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> trt, <span class="at">data =</span> sugar)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(sugar.aov)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) trtA trtB trtC
1            1    0    0    0
2            1    0    0    0
3            1    0    0    0
4            1    1    0    0
5            1    1    0    0
6            1    1    0    0
7            1    0    1    0
8            1    0    1    0
9            1    0    1    0
10           1    0    0    1
11           1    0    0    1
12           1    0    0    1
attr(,"assign")
[1] 0 1 1 1
attr(,"contrasts")
attr(,"contrasts")$trt
[1] "contr.treatment"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.lm</span>(sugar.aov)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aov(formula = weight ~ trt, data = sugar)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.3333  -2.7833  -0.6167   2.1750  14.5667 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   83.233      4.473  18.609 7.17e-08 ***
trtA         -21.400      6.325  -3.383 0.009597 ** 
trtB         -15.733      6.325  -2.487 0.037680 *  
trtC         -34.333      6.325  -5.428 0.000625 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.747 on 8 degrees of freedom
Multiple R-squared:  0.7915,    Adjusted R-squared:  0.7133 
F-statistic: 10.12 on 3 and 8 DF,  p-value: 0.004248</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>El intercepto está asociado a una categoría base (por ejemplo, <strong>Control</strong>).<br>
</li>
<li>Cada coeficiente representa la <strong>diferencia</strong> de cada tratamiento respecto al control.<br>
</li>
<li>Probamos si hay diferencias significativas en el peso promedio entre tratamientos.</li>
</ul>
</div>
</div>
</section>
<section id="medias-y-comparaciones-múltiples-tukey" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="medias-y-comparaciones-múltiples-tukey"><span class="header-section-number">4.2.2</span> Medias y comparaciones múltiples (Tukey)</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(sugar.aov)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7        8 
83.23333 83.23333 83.23333 61.83333 61.83333 61.83333 67.50000 67.50000 
       9       10       11       12 
67.50000 48.90000 48.90000 48.90000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>sem <span class="ot">&lt;-</span> <span class="fu">summary.lm</span>(sugar.aov)<span class="sc">$</span>sigma <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">3</span>)  <span class="co"># 3 observaciones por grupo</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(sugar<span class="sc">$</span>weight <span class="sc">~</span> sugar<span class="sc">$</span>trt,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Tratamiento"</span>, <span class="at">ylab =</span> <span class="st">"Peso"</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Distribución de peso por tratamiento"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/sugar-posthoc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(sugar.aov, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = weight ~ trt, data = sugar)

$trt
                diff       lwr        upr     p adj
A-Control -21.400000 -41.65627  -1.143735 0.0388013
B-Control -15.733333 -35.98960   4.522932 0.1368094
C-Control -34.333333 -54.58960 -14.077068 0.0027770
B-A         5.666667 -14.58960  25.922932 0.8074414
C-A       -12.933333 -33.18960   7.322932 0.2491650
C-B       -18.600000 -38.85627   1.656265 0.0723466</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(sugar.aov, <span class="at">conf.level =</span> <span class="fl">0.95</span>), <span class="at">las =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/sugar-posthoc-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="anova-de-dos-factores-appletaste" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="anova-de-dos-factores-appletaste"><span class="header-section-number">4.3</span> ANOVA de dos factores: <code>appletaste</code></h2>
<p>Este dataset contiene evaluaciones de aftertaste (sabor residual) de distintos productos de manzana por distintos panelistas.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(appletaste)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(appletaste)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  aftertaste panelist product
1         89        a     937
2         98        a     298
3        108        a     493
4         13        b     937
5         55        b     298
6        104        b     493</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminamos un panelista en particular (k)</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>appletaste1 <span class="ot">&lt;-</span> appletaste[appletaste<span class="sc">$</span>panelist <span class="sc">!=</span> <span class="st">"k"</span>, ]</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(appletaste1<span class="sc">$</span>product, appletaste1<span class="sc">$</span>panelist)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
      a b c d e f g h i j k l m n o p q r s t
  298 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1
  493 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 1 1 1 1 1
  649 0 0 0 0 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1
  937 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 0 0 0 0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(appletaste1, is.factor)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>aftertaste   panelist    product 
     FALSE       TRUE       TRUE </code></pre>
</div>
</div>
<section id="anova-con-panelista-y-producto" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="anova-con-panelista-y-producto"><span class="header-section-number">4.3.1</span> ANOVA con panelista y producto</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>appletaste.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(aftertaste <span class="sc">~</span> panelist <span class="sc">+</span> product,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> appletaste1)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(appletaste.aov)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
panelist    18  25396    1411   1.913   0.0492 *  
product      3  35073   11691  15.851 1.12e-06 ***
Residuals   35  25815     738                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(appletaste1<span class="sc">$</span>aftertaste <span class="sc">~</span> appletaste1<span class="sc">$</span>product,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Aftertaste por producto"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/appletaste-anova-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(appletaste1<span class="sc">$</span>aftertaste <span class="sc">~</span> appletaste1<span class="sc">$</span>panelist,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Aftertaste por panelista"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/appletaste-anova-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(appletaste.aov, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = aftertaste ~ panelist + product, data = appletaste1)

$panelist
           diff        lwr        upr     p adj
b-a -41.0000000 -125.08231  43.082307 0.9239145
c-a   5.0000000  -79.08231  89.082307 1.0000000
d-a -25.0000000 -109.08231  59.082307 0.9995641
e-a -26.3333333 -110.41564  57.748974 0.9991587
f-a -34.6666667 -118.74897  49.415641 0.9822057
g-a -60.3333333 -144.41564  23.748974 0.4246450
h-a -43.0000000 -127.08231  41.082307 0.8920491
i-a -12.0000000  -96.08231  72.082307 1.0000000
j-a  -7.0000000  -91.08231  77.082307 1.0000000
l-a -59.3333333 -143.41564  24.748974 0.4530346
m-a -30.6666667 -114.74897  53.415641 0.9949812
n-a -40.0000000 -124.08231  44.082307 0.9372358
o-a -61.3333333 -145.41564  22.748974 0.3970457
p-a -32.3333333 -116.41564  51.748974 0.9911582
q-a -47.6666667 -131.74897  36.415641 0.7913417
r-a -30.3333333 -114.41564  53.748974 0.9955513
s-a -45.0000000 -129.08231  39.082307 0.8532101
t-a -77.3333333 -161.41564   6.748974 0.1012762
c-b  46.0000000  -38.08231 130.082307 0.8312840
d-b  16.0000000  -68.08231 100.082307 0.9999993
e-b  14.6666667  -69.41564  98.748974 0.9999998
f-b   6.3333333  -77.74897  90.415641 1.0000000
g-b -19.3333333 -103.41564  64.748974 0.9999875
h-b  -2.0000000  -86.08231  82.082307 1.0000000
i-b  29.0000000  -55.08231 113.082307 0.9973249
j-b  34.0000000  -50.08231 118.082307 0.9852771
l-b -18.3333333 -102.41564  65.748974 0.9999943
m-b  10.3333333  -73.74897  94.415641 1.0000000
n-b   1.0000000  -83.08231  85.082307 1.0000000
o-b -20.3333333 -104.41564  63.748974 0.9999740
p-b   8.6666667  -75.41564  92.748974 1.0000000
q-b  -6.6666667  -90.74897  77.415641 1.0000000
r-b  10.6666667  -73.41564  94.748974 1.0000000
s-b  -4.0000000  -88.08231  80.082307 1.0000000
t-b -36.3333333 -120.41564  47.748974 0.9723614
d-c -30.0000000 -114.08231  54.082307 0.9960668
e-c -31.3333333 -115.41564  52.748974 0.9936600
f-c -39.6666667 -123.74897  44.415641 0.9412994
g-c -65.3333333 -149.41564  18.748974 0.2963345
h-c -48.0000000 -132.08231  36.082307 0.7828845
i-c -17.0000000 -101.08231  67.082307 0.9999982
j-c -12.0000000  -96.08231  72.082307 1.0000000
l-c -64.3333333 -148.41564  19.748974 0.3199219
m-c -35.6666667 -119.74897  48.415641 0.9766966
n-c -45.0000000 -129.08231  39.082307 0.8532101
o-c -66.3333333 -150.41564  17.748974 0.2738830
p-c -37.3333333 -121.41564  46.748974 0.9647639
q-c -52.6666667 -136.74897  31.415641 0.6522222
r-c -35.3333333 -119.41564  48.748974 0.9786603
s-c -50.0000000 -134.08231  34.082307 0.7293259
t-c -82.3333333 -166.41564   1.748974 0.0603829
e-d  -1.3333333  -85.41564  82.748974 1.0000000
f-d  -9.6666667  -93.74897  74.415641 1.0000000
g-d -35.3333333 -119.41564  48.748974 0.9786603
h-d -18.0000000 -102.08231  66.082307 0.9999957
i-d  13.0000000  -71.08231  97.082307 1.0000000
j-d  18.0000000  -66.08231 102.082307 0.9999957
l-d -34.3333333 -118.41564  49.748974 0.9837980
m-d  -5.6666667  -89.74897  78.415641 1.0000000
n-d -15.0000000  -99.08231  69.082307 0.9999997
o-d -36.3333333 -120.41564  47.748974 0.9723614
p-d  -7.3333333  -91.41564  76.748974 1.0000000
q-d -22.6666667 -106.74897  61.415641 0.9998811
r-d  -5.3333333  -89.41564  78.748974 1.0000000
s-d -20.0000000 -104.08231  64.082307 0.9999796
t-d -52.3333333 -136.41564  31.748974 0.6621111
f-e  -8.3333333  -92.41564  75.748974 1.0000000
g-e -34.0000000 -118.08231  50.082307 0.9852771
h-e -16.6666667 -100.74897  67.415641 0.9999987
i-e  14.3333333  -69.74897  98.415641 0.9999999
j-e  19.3333333  -64.74897 103.415641 0.9999875
l-e -33.0000000 -117.08231  51.082307 0.9890877
m-e  -4.3333333  -88.41564  79.748974 1.0000000
n-e -13.6666667  -97.74897  70.415641 0.9999999
o-e -35.0000000 -119.08231  49.082307 0.9804949
p-e  -6.0000000  -90.08231  78.082307 1.0000000
q-e -21.3333333 -105.41564  62.748974 0.9999487
r-e  -4.0000000  -88.08231  80.082307 1.0000000
s-e -18.6666667 -102.74897  65.415641 0.9999926
t-e -51.0000000 -135.08231  33.082307 0.7010209
g-f -25.6666667 -109.74897  58.415641 0.9993900
h-f  -8.3333333  -92.41564  75.748974 1.0000000
i-f  22.6666667  -61.41564 106.748974 0.9998811
j-f  27.6666667  -56.41564 111.748974 0.9984622
l-f -24.6666667 -108.74897  59.415641 0.9996335
m-f   4.0000000  -80.08231  88.082307 1.0000000
n-f  -5.3333333  -89.41564  78.748974 1.0000000
o-f -26.6666667 -110.74897  57.415641 0.9990169
p-f   2.3333333  -81.74897  86.415641 1.0000000
q-f -13.0000000  -97.08231  71.082307 1.0000000
r-f   4.3333333  -79.74897  88.415641 1.0000000
s-f -10.3333333  -94.41564  73.748974 1.0000000
t-f -42.6666667 -126.74897  41.415641 0.8978483
h-g  17.3333333  -66.74897 101.415641 0.9999976
i-g  48.3333333  -35.74897 132.415641 0.7742833
j-g  53.3333333  -30.74897 137.415641 0.6323007
l-g   1.0000000  -83.08231  85.082307 1.0000000
m-g  29.6666667  -54.41564 113.748974 0.9965317
n-g  20.3333333  -63.74897 104.415641 0.9999740
o-g  -1.0000000  -85.08231  83.082307 1.0000000
p-g  28.0000000  -56.08231 112.082307 0.9982261
q-g  12.6666667  -71.41564  96.748974 1.0000000
r-g  30.0000000  -54.08231 114.082307 0.9960668
s-g  15.3333333  -68.74897  99.415641 0.9999996
t-g -17.0000000 -101.08231  67.082307 0.9999982
i-h  31.0000000  -53.08231 115.082307 0.9943522
j-h  36.0000000  -48.08231 120.082307 0.9745987
l-h -16.3333333 -100.41564  67.748974 0.9999990
m-h  12.3333333  -71.74897  96.415641 1.0000000
n-h   3.0000000  -81.08231  87.082307 1.0000000
o-h -18.3333333 -102.41564  65.748974 0.9999943
p-h  10.6666667  -73.41564  94.748974 1.0000000
q-h  -4.6666667  -88.74897  79.415641 1.0000000
r-h  12.6666667  -71.41564  96.748974 1.0000000
s-h  -2.0000000  -86.08231  82.082307 1.0000000
t-h -34.3333333 -118.41564  49.748974 0.9837980
j-i   5.0000000  -79.08231  89.082307 1.0000000
l-i -47.3333333 -131.41564  36.748974 0.7996494
m-i -18.6666667 -102.74897  65.415641 0.9999926
n-i -28.0000000 -112.08231  56.082307 0.9982261
o-i -49.3333333 -133.41564  34.748974 0.7476743
p-i -20.3333333 -104.41564  63.748974 0.9999740
q-i -35.6666667 -119.74897  48.415641 0.9766966
r-i -18.3333333 -102.41564  65.748974 0.9999943
s-i -33.0000000 -117.08231  51.082307 0.9890877
t-i -65.3333333 -149.41564  18.748974 0.2963345
l-j -52.3333333 -136.41564  31.748974 0.6621111
m-j -23.6666667 -107.74897  60.415641 0.9997873
n-j -33.0000000 -117.08231  51.082307 0.9890877
o-j -54.3333333 -138.41564  29.748974 0.6021671
p-j -25.3333333 -109.41564  58.748974 0.9994834
q-j -40.6666667 -124.74897  43.415641 0.9285454
r-j -23.3333333 -107.41564  60.748974 0.9998240
s-j -38.0000000 -122.08231  46.082307 0.9589140
t-j -70.3333333 -154.41564  13.748974 0.1957341
m-l  28.6666667  -55.41564 112.748974 0.9976605
n-l  19.3333333  -64.74897 103.415641 0.9999875
o-l  -2.0000000  -86.08231  82.082307 1.0000000
p-l  27.0000000  -57.08231 111.082307 0.9988552
q-l  11.6666667  -72.41564  95.748974 1.0000000
r-l  29.0000000  -55.08231 113.082307 0.9973249
s-l  14.3333333  -69.74897  98.415641 0.9999999
t-l -18.0000000 -102.08231  66.082307 0.9999957
n-m  -9.3333333  -93.41564  74.748974 1.0000000
o-m -30.6666667 -114.74897  53.415641 0.9949812
p-m  -1.6666667  -85.74897  82.415641 1.0000000
q-m -17.0000000 -101.08231  67.082307 0.9999982
r-m   0.3333333  -83.74897  84.415641 1.0000000
s-m -14.3333333  -98.41564  69.748974 0.9999999
t-m -46.6666667 -130.74897  37.415641 0.8157955
o-n -21.3333333 -105.41564  62.748974 0.9999487
p-n   7.6666667  -76.41564  91.748974 1.0000000
q-n  -7.6666667  -91.74897  76.415641 1.0000000
r-n   9.6666667  -74.41564  93.748974 1.0000000
s-n  -5.0000000  -89.08231  79.082307 1.0000000
t-n -37.3333333 -121.41564  46.748974 0.9647639
p-o  29.0000000  -55.08231 113.082307 0.9973249
q-o  13.6666667  -70.41564  97.748974 0.9999999
r-o  31.0000000  -53.08231 115.082307 0.9943522
s-o  16.3333333  -67.74897 100.415641 0.9999990
t-o -16.0000000 -100.08231  68.082307 0.9999993
q-p -15.3333333  -99.41564  68.748974 0.9999996
r-p   2.0000000  -82.08231  86.082307 1.0000000
s-p -12.6666667  -96.74897  71.415641 1.0000000
t-p -45.0000000 -129.08231  39.082307 0.8532101
r-q  17.3333333  -66.74897 101.415641 0.9999976
s-q   2.6666667  -81.41564  86.748974 1.0000000
t-q -29.6666667 -113.74897  54.415641 0.9965317
s-r -14.6666667  -98.74897  69.415641 0.9999998
t-r -47.0000000 -131.08231  37.082307 0.8078023
t-s -32.3333333 -116.41564  51.748974 0.9911582

$product
             diff       lwr        upr     p adj
493-298  17.84286  -9.37496  45.060674 0.3054791
649-298 -12.52381 -40.20692  15.159303 0.6185367
937-298 -46.04762 -73.73073 -18.364507 0.0004190
649-493 -30.36667 -57.58448  -3.148850 0.0238482
937-493 -63.89048 -91.10829 -36.672659 0.0000017
937-649 -33.52381 -61.20692  -5.840697 0.0124799</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>El ANOVA permite separar el efecto del <strong>producto</strong> del efecto del <strong>panelista</strong>.<br>
</li>
<li>En la práctica, nos interesa si el <strong>producto</strong> tiene un efecto significativo en la evaluación, más allá de la variabilidad entre panelistas.</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="parte-3-manova-y-análisis-multivariante-con-datos-de-ratas" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Parte 3: MANOVA y análisis multivariante con datos de ratas</h1>
<p>En este último ejemplo se trabaja con datos simulados de ratas con:</p>
<ul>
<li><code>y1</code>: peso inicial.<br>
</li>
<li><code>y2</code>: peso final.<br>
</li>
<li><code>y3</code>: peso del tumor.<br>
</li>
<li>Factores: <code>temp</code> (temperatura ambiental) y <code>sex</code> (sexo).</li>
</ul>
<section id="generar-el-dataset" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="generar-el-dataset"><span class="header-section-number">5.1</span> Generar el dataset</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>pesos <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">18.15</span>, <span class="fl">16.51</span>, <span class="fl">0.24</span>, <span class="fl">19.15</span>, <span class="fl">19.49</span>, <span class="fl">0.16</span>, <span class="fl">18.68</span>,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">19.50</span>, <span class="fl">0.32</span>, <span class="fl">18.35</span>, <span class="fl">19.81</span>, <span class="fl">0.17</span>, <span class="fl">19.54</span>, <span class="fl">19.84</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.20</span>, <span class="fl">20.58</span>, <span class="fl">19.44</span>, <span class="fl">0.22</span>, <span class="fl">21.27</span>, <span class="fl">23.30</span>, <span class="fl">0.33</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">18.87</span>, <span class="fl">22.00</span>, <span class="fl">0.25</span>, <span class="fl">19.57</span>, <span class="fl">22.30</span>, <span class="fl">0.45</span>, <span class="fl">20.66</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">21.08</span>, <span class="fl">0.20</span>, <span class="fl">20.15</span>, <span class="fl">18.95</span>, <span class="fl">0.35</span>, <span class="fl">21.56</span>, <span class="fl">20.34</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.20</span>, <span class="fl">20.74</span>, <span class="fl">16.69</span>, <span class="fl">0.31</span>, <span class="fl">20.22</span>, <span class="fl">19.00</span>, <span class="fl">0.18</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">20.02</span>, <span class="fl">19.26</span>, <span class="fl">0.41</span>, <span class="fl">18.38</span>, <span class="fl">17.92</span>, <span class="fl">0.30</span>, <span class="fl">17.20</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">15.90</span>, <span class="fl">0.28</span>, <span class="fl">20.85</span>, <span class="fl">19.90</span>, <span class="fl">0.17</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> pesos[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>)]</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> pesos[<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)]</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> pesos[<span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>)]</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">20</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">34</span>, <span class="dv">6</span>)))</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>sex  <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"M"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"H"</span>, <span class="dv">3</span>)), <span class="dv">3</span>))</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>ratas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y1, y2, y3, temp, sex)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ratas)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     y1    y2   y3 temp sex
1 18.15 16.51 0.24    4   M
2 19.15 19.49 0.16    4   M
3 18.68 19.50 0.32    4   M
4 18.35 19.81 0.17    4   H
5 19.54 19.84 0.20    4   H
6 20.58 19.44 0.22    4   H</code></pre>
</div>
</div>
</section>
<section id="boxplots-exploratorios" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="boxplots-exploratorios"><span class="header-section-number">5.2</span> Boxplots exploratorios</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(ratas, <span class="at">x =</span> <span class="st">"sex"</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>),</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">merge =</span> <span class="cn">TRUE</span>, <span class="at">palette =</span> <span class="st">"jco"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/ratas-boxplots-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(ratas, <span class="at">x =</span> <span class="st">"temp"</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>),</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">merge =</span> <span class="cn">TRUE</span>, <span class="at">palette =</span> <span class="st">"jco"</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/ratas-boxplots-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estadísticos-agrupados-media-n-sd" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="estadísticos-agrupados-media-n-sd"><span class="header-section-number">5.3</span> Estadísticos agrupados (media, n, sd)</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(ratas[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">list</span>(<span class="at">sex =</span> ratas<span class="sc">$</span>sex, <span class="at">temp =</span> ratas<span class="sc">$</span>temp), mean)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sex temp       y1       y2        y3
1   H    4 19.49000 19.69667 0.1966667
2   M    4 18.66000 18.50000 0.2400000
3   H   20 20.79000 20.12333 0.2500000
4   M   20 19.90333 22.53333 0.3433333
5   H   34 18.81000 17.90667 0.2500000
6   M   34 20.32667 18.31667 0.3000000</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(ratas[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">list</span>(<span class="at">sex =</span> ratas<span class="sc">$</span>sex, <span class="at">temp =</span> ratas<span class="sc">$</span>temp), length)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sex temp y1 y2 y3
1   H    4  3  3  3
2   M    4  3  3  3
3   H   20  3  3  3
4   M   20  3  3  3
5   H   34  3  3  3
6   M   34  3  3  3</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(ratas[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">list</span>(<span class="at">sex =</span> ratas<span class="sc">$</span>sex, <span class="at">temp =</span> ratas<span class="sc">$</span>temp), sd)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sex temp        y1        y2         y3
1   H    4 1.1158405 0.2227854 0.02516611
2   M    4 0.5002999 1.7233978 0.08000000
3   H   20 0.7139328 1.0814034 0.08660254
4   M   20 1.2342339 0.6806859 0.10066446
5   H   34 1.8626057 2.0000333 0.07000000
6   M   34 0.3716629 1.4147202 0.11532563</code></pre>
</div>
</div>
</section>
<section id="normalidad-univariada-por-grupo" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="normalidad-univariada-por-grupo"><span class="header-section-number">5.4</span> Normalidad univariada por grupo</h2>
<p>Definimos una función que calcula el p-value del test de Shapiro–Wilk:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>normal <span class="ot">&lt;-</span> <span class="cf">function</span>(vec){</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>(vec)<span class="sc">$</span>p.value</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(ratas[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">list</span>(<span class="at">sex =</span> ratas<span class="sc">$</span>sex, <span class="at">temp =</span> ratas<span class="sc">$</span>temp), normal)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sex temp        y1          y2        y3
1   H    4 0.9258674 0.128686974 0.7804408
2   M    4 0.9338670 0.005540978 1.0000000
3   H   20 0.6975632 0.666926507 0.0000000
4   M   20 0.5491264 0.424350926 0.7804408
5   H   34 0.6155710 0.988973545 0.2737737
6   M   34 0.5202800 0.175746733 0.8564460</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>P-values grandes sugieren que <strong>no podemos rechazar</strong> normalidad para esa combinación de grupo y variable.<br>
</li>
<li>Esto es un requisito para aplicar ANOVA/MANOVA de forma estricta.</li>
</ul>
</div>
</div>
</section>
<section id="modelos-manova" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="modelos-manova"><span class="header-section-number">5.5</span> Modelos MANOVA</h2>
<p>Planteamos distintos modelos multivariantes:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>mod1   <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(y1, y2, y3) <span class="sc">~</span> sex <span class="sc">+</span> temp, <span class="at">data =</span> ratas)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df  Pillai approx F num Df den Df  Pr(&gt;F)  
sex        1 0.21483   1.0945      3     12 0.38905  
temp       2 0.80234   2.9030      6     26 0.02656 *
Residuals 14                                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>mod1<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(y1, y2, y3) <span class="sc">~</span> temp, <span class="at">data =</span> ratas)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1<span class="fl">.1</span>)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df  Pillai approx F num Df den Df  Pr(&gt;F)  
temp       2 0.76682   2.9018      6     28 0.02503 *
Residuals 15                                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>mod2   <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(y1, y2, y3) <span class="sc">~</span> sex <span class="sc">*</span> temp, <span class="at">data =</span> ratas)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df  Pillai approx F num Df den Df  Pr(&gt;F)  
sex        1 0.27510   1.2650      3     10 0.33838  
temp       2 0.97019   3.4544      6     22 0.01475 *
sex:temp   2 0.75271   2.2128      6     22 0.08041 .
Residuals 12                                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>MANOVA evalúa si los factores (sexo, temperatura, e interacción) tienen efectos <strong>conjuntos</strong> sobre el vector <span class="math inline">\((y1, y2, y3)\)</span>.<br>
</li>
<li>Si hay significancia, se justifica mirar luego análisis univariados para cada variable por separado.</li>
</ul>
</div>
</div>
</section>
<section id="anova-univariados-asociados" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="anova-univariados-asociados"><span class="header-section-number">5.6</span> ANOVA univariados asociados</h2>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y1 <span class="sc">~</span> temp,        <span class="at">data =</span> ratas)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y2 <span class="sc">~</span> temp,        <span class="at">data =</span> ratas)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y3 <span class="sc">~</span> temp,        <span class="at">data =</span> ratas)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y1 <span class="sc">~</span> temp <span class="sc">*</span> sex,  <span class="at">data =</span> ratas)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y2 <span class="sc">~</span> temp <span class="sc">*</span> sex,  <span class="at">data =</span> ratas)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>m6 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y3 <span class="sc">~</span> temp <span class="sc">*</span> sex,  <span class="at">data =</span> ratas)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
temp         2  4.933   2.466   1.856   0.19
Residuals   15 19.935   1.329               </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
temp         2  32.59  16.293   7.538 0.00542 **
Residuals   15  32.42   2.161                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Sum Sq  Mean Sq F value Pr(&gt;F)
temp         2 0.01963 0.009817   1.398  0.278
Residuals   15 0.10537 0.007024               </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
temp         2  4.933   2.466   2.074  0.168
sex          1  0.020   0.020   0.017  0.899
temp:sex     2  5.643   2.821   2.372  0.135
Residuals   12 14.272   1.189               </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
temp         2  32.59  16.293   9.176 0.00382 **
sex          1   1.32   1.318   0.742 0.40590   
temp:sex     2   9.79   4.897   2.758 0.10339   
Residuals   12  21.31   1.776                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m6)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Sum Sq  Mean Sq F value Pr(&gt;F)
temp         2 0.01963 0.009817   1.374  0.290
sex          1 0.01742 0.017422   2.439  0.144
temp:sex     2 0.00221 0.001106   0.155  0.858
Residuals   12 0.08573 0.007144               </code></pre>
</div>
</div>
<section id="tamaño-de-efecto-eta-cuadrado" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="tamaño-de-efecto-eta-cuadrado"><span class="header-section-number">5.6.1</span> Tamaño de efecto (eta cuadrado)</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">etaSquared</span>(m2)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        eta.sq eta.sq.part
temp 0.5012788   0.5012788</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">etaSquared</span>(m5)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             eta.sq eta.sq.part
temp     0.50127879  0.60463503
sex      0.02026862  0.05823481
temp:sex 0.15067126  0.31491368</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Regla de interpretación de <strong>eta²</strong> (aproximada):</p>
<ul>
<li>0.01 → efecto pequeño.<br>
</li>
<li>0.06 → efecto mediano.<br>
</li>
<li><blockquote class="blockquote">
<p>0.14 → efecto grande.</p>
</blockquote></li>
</ul>
<p>Esto ayuda a complementar la <strong>significancia estadística</strong> con una medida de <strong>magnitud del efecto</strong>.</p>
</div>
</div>
</section>
<section id="comparaciones-múltiples-tukey-para-una-de-las-anova" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="comparaciones-múltiples-tukey-para-una-de-las-anova"><span class="header-section-number">5.6.2</span> Comparaciones múltiples (Tukey) para una de las ANOVA</h3>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(m2)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>post</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = y2 ~ temp, data = ratas)

$temp
            diff         lwr       upr     p adj
20-4   2.2300000  0.02527797  4.434722 0.0472590
34-4  -0.9866667 -3.19138869  1.218055 0.4924782
34-20 -3.2166667 -5.42138869 -1.011945 0.0047632</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(post)</span></code></pre></div><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="lab05_epg_files/figure-html/ratas-tukey-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="cierre-del-laboratorio" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Cierre del laboratorio</h1>
<p>En este capítulo trabajaste con:</p>
<ul>
<li><p><strong>Modelos logit</strong> en contexto espacial (<code>frogs</code>) y con tablas de contingencia (<code>UCBAdmissions</code>), aprendiendo a:</p>
<ul>
<li>Interpretar coeficientes en términos de <strong>odds ratios</strong>.<br>
</li>
<li>Evaluar desempeño mediante <strong>ROC</strong>, <strong>AUC</strong>, matrices de confusión y accuracy.</li>
</ul></li>
<li><p><strong>ANOVA</strong> para comparar medias entre tratamientos (<code>sugar</code>) y para diseños con dos factores (<code>appletaste</code>).</p></li>
<li><p><strong>MANOVA</strong> y análisis multivariante (<code>ratas</code>), incluyendo:</p>
<ul>
<li>Comprobación de supuestos (normalidad, homogeneidad de varianzas).<br>
</li>
<li>Interpretación de efectos conjuntos e individuales.<br>
</li>
<li>Tamaño de efecto mediante <strong>eta²</strong>.</li>
</ul></li>
</ul>
<p>Estos procedimientos son la base para muchos análisis empíricos modernos en economía, negocios, salud y ciencias sociales, más allá del modelo de regresión lineal clásico.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/fen-uah\.github\.io\/lab-econometria\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 FEN-UAH</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Sitio desarrollado con Quarto</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>